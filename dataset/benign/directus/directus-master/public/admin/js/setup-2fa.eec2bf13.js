(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["setup-2fa"],{3021:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("PublicView",{attrs:{heading:e.$t("setup_2fa")}},[!1!==e.finished||e.fetchingData?e._e():[r("p",[e._v(" Scan this QR code with your authenticator app, then enter the verification code it provides to complete setup. ")]),e.tfa_secret?r("qr-code",{staticClass:"qr",attrs:{value:e.totpUrl,options:{width:340}}}):r("v-spinner"),r("otp-input",{on:{input:e.save2faSecret}})],!0!==e.finished||e.fetchingData?e._e():[r("p",[e._v(" Congratulations! You have successfully set up 2-factor authentication for Directus. ")]),r("button",{attrs:{type:"button"},on:{click:e.enterApp}},[e._v("Continue")])],e.saving||e.fetchingData?r("v-progress-linear",{staticClass:"loading",attrs:{indeterminate:"",rounded:""}}):e._e(),e.error?r("public-notice",{attrs:{slot:"notice",color:"danger"},slot:"notice"},[e._v(" "+e._s(e.$t("errors."+e.error.code))+" ")]):e._e()],2)},a=[],c=(r("a4d3"),r("99af"),r("4de4"),r("4160"),r("e439"),r("dbb4"),r("b64b"),r("159b"),r("96cf"),r("1da1")),i=r("ade3"),o=r("89b3"),s=r("8a0c"),u=r("b2e5"),p=r.n(u),f=r("2f62"),l=r("b56c"),h=r("e59c");function b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){Object(i["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var d={name:"Setup2FA",components:{PublicView:o["a"],PublicNotice:s["a"],QrCode:p.a,OtpInput:l["a"]},data:function(){return{tfa_secret:null,error:null,finished:!1,saving:!1,fetchingData:!1}},computed:v({},Object(f["e"])(["apiRootPath","currentProjectKey"]),{totpUrl:function(){return"otpauth://totp/Directus:".concat(this.$store.state.currentUser.email,"?secret=").concat(this.tfa_secret,"&issuer=Directus")}}),created:function(){this.fetch2faSecret()},methods:{fetch2faSecret:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.api.get("/utils/2fa_secret");case 2:r=t.sent,e.tfa_secret=r.data["2fa_secret"];case 4:case"end":return t.stop()}}),t)})))()},save2faSecret:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var n,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.saving=!0,n={},Object(i["a"])(n,"2fa_secret",t.tfa_secret),Object(i["a"])(n,"otp",e),a=n,r.prev=2,r.next=5,t.$api.api.post("/users/me/activate_2fa",a);case 5:t.finished=!0,r.next=12;break;case 8:r.prev=8,r.t0=r["catch"](2),t.error=r.t0,console.error(r.t0);case 12:return r.prev=12,t.saving=!1,r.finish(12);case 15:case"end":return r.stop()}}),r,null,[[2,8,12,15]])})))()},enterApp:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.fetchingData=!0,t.next=3,Object(h["a"])();case 3:r="/".concat(e.currentProjectKey,"/collections"),e.$store.state.currentUser.last_page&&(r=e.$store.state.currentUser.last_page),e.$route.query.redirect&&(r=e.$route.query.redirect),e.$router.push(r,(function(){e.fetchingData=!1}));case 7:case"end":return t.stop()}}),t)})))()}}},g=d,O=(r("cb47"),r("c193"),r("2877")),w=Object(O["a"])(g,n,a,!1,null,"2379f7ec",null);t["default"]=w.exports},3512:function(e,t,r){},"39a5":function(e,t,r){},c193:function(e,t,r){"use strict";var n=r("39a5"),a=r.n(n);a.a},cb47:function(e,t,r){"use strict";var n=r("3512"),a=r.n(n);a.a}}]);
//# sourceMappingURL=setup-2fa.eec2bf13.js.map