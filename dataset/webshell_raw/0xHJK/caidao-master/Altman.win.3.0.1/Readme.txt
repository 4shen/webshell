Based on Eto, do some changes. By KeePwn.